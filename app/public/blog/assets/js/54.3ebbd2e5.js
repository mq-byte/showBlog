(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{216:function(e,t,s){"use strict";s.r(t);var n=s(3),a=Object(n.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"tls-ssl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-ssl"}},[e._v("#")]),e._v(" TLS (SSL)")]),e._v(" "),s("blockquote",[s("p",[e._v("Stability: 2 - Stable")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tls")]),e._v(" module provides an implementation of the Transport Layer Security\n(TLS) and Secure Socket Layer (SSL) protocols that is built on top of OpenSSL.\nThe module can be accessed using:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" tls "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'tls'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("h2",{attrs:{id:"tls-ssl-concepts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-ssl-concepts"}},[e._v("#")]),e._v(" TLS/SSL Concepts")]),e._v(" "),s("p",[e._v("The TLS/SSL is a public/private key infrastructure (PKI). For most common\ncases, each client and server must have a "),s("em",[e._v("private key")]),e._v(".")]),e._v(" "),s("p",[e._v("Private keys can be generated in multiple ways. The example below illustrates\nuse of the OpenSSL command-line interface to generate a 2048-bit RSA private\nkey:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("openssl genrsa -out ryans-key.pem "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2048")]),e._v("\n")])])]),s("p",[e._v("With TLS/SSL, all servers (and some clients) must have a "),s("em",[e._v("certificate")]),e._v(".\nCertificates are "),s("em",[e._v("public keys")]),e._v(' that correspond to a private key, and that are\ndigitally signed either by a Certificate Authority or by the owner of the\nprivate key (such certificates are referred to as "self-signed"). The first\nstep to obtaining a certificate is to create a '),s("em",[e._v("Certificate Signing Request")]),e._v("\n(CSR) file.")]),e._v(" "),s("p",[e._v("The OpenSSL command-line interface can be used to generate a CSR for a private\nkey:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("openssl req -new -sha256 -key ryans-key.pem -out ryans-csr.pem\n")])])]),s("p",[e._v("Once the CSR file is generated, it can either be sent to a Certificate\nAuthority for signing or used to generate a self-signed certificate.")]),e._v(" "),s("p",[e._v("Creating a self-signed certificate using the OpenSSL command-line interface\nis illustrated in the example below:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("openssl x509 -req -in ryans-csr.pem -signkey ryans-key.pem -out ryans-cert.pem\n")])])]),s("p",[e._v("Once the certificate is generated, it can be used to generate a "),s("code",[e._v(".pfx")]),e._v(" or\n"),s("code",[e._v(".p12")]),e._v(" file:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("openssl pkcs12 -export -in ryans-cert.pem -inkey ryans-key.pem "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n      -certfile ca-cert.pem -out ryans.pfx\n")])])]),s("p",[e._v("Where:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("in")]),e._v(": is the signed certificate")]),e._v(" "),s("li",[s("code",[e._v("inkey")]),e._v(": is the associated private key")]),e._v(" "),s("li",[s("code",[e._v("certfile")]),e._v(": is a concatenation of all Certificate Authority (CA) certs into\na single file, e.g. "),s("code",[e._v("cat ca1-cert.pem ca2-cert.pem > ca-cert.pem")])])]),e._v(" "),s("h3",{attrs:{id:"perfect-forward-secrecy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#perfect-forward-secrecy"}},[e._v("#")]),e._v(" Perfect Forward Secrecy")]),e._v(" "),s("p",[e._v('The term "'),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Perfect_forward_secrecy",target:"_blank",rel:"noopener noreferrer"}},[e._v("Forward Secrecy"),s("OutboundLink")],1),e._v('" or "Perfect Forward Secrecy" describes a feature\nof key-agreement (i.e., key-exchange) methods. That is, the server and client\nkeys are used to negotiate new temporary keys that are used specifically and\nonly for the current communication session. Practically, this means that even\nif the server\'s private key is compromised, communication can only be decrypted\nby eavesdroppers if the attacker manages to obtain the key-pair specifically\ngenerated for the session.')]),e._v(" "),s("p",[e._v('Perfect Forward Secrecy is achieved by randomly generating a key pair for\nkey-agreement on every TLS/SSL handshake (in contrast to using the same key for\nall sessions). Methods implementing this technique are called "ephemeral".')]),e._v(" "),s("p",[e._v('Currently two methods are commonly used to achieve Perfect Forward Secrecy (note\nthe character "E" appended to the traditional abbreviations):')]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange",target:"_blank",rel:"noopener noreferrer"}},[e._v("DHE"),s("OutboundLink")],1),e._v(": An ephemeral version of the Diffie Hellman key-agreement protocol.")]),e._v(" "),s("li",[s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman",target:"_blank",rel:"noopener noreferrer"}},[e._v("ECDHE"),s("OutboundLink")],1),e._v(": An ephemeral version of the Elliptic Curve Diffie Hellman\nkey-agreement protocol.")])]),e._v(" "),s("p",[e._v("Ephemeral methods may have some performance drawbacks, because key generation\nis expensive.")]),e._v(" "),s("p",[e._v("To use Perfect Forward Secrecy using "),s("code",[e._v("DHE")]),e._v(" with the "),s("code",[e._v("tls")]),e._v(" module, it is required\nto generate Diffie-Hellman parameters and specify them with the "),s("code",[e._v("dhparam")]),e._v("\noption to "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(". The following illustrates the use of\nthe OpenSSL command-line interface to generate such parameters:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("openssl dhparam -outform PEM -out dhparam.pem "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("2048")]),e._v("\n")])])]),s("p",[e._v("If using Perfect Forward Secrecy using "),s("code",[e._v("ECDHE")]),e._v(", Diffie-Hellman parameters are\nnot required and a default ECDHE curve will be used. The "),s("code",[e._v("ecdhCurve")]),e._v(" property\ncan be used when creating a TLS Server to specify the list of names of supported\ncurves to use, see "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(" for more info.")]),e._v(" "),s("p",[e._v("Perfect Forward Secrecy was optional up to TLSv1.2, but it is not optional for\nTLSv1.3, because all TLSv1.3 cipher suites use ECDHE.")]),e._v(" "),s("h3",{attrs:{id:"alpn-and-sni"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alpn-and-sni"}},[e._v("#")]),e._v(" ALPN and SNI")]),e._v(" "),s("p",[e._v("ALPN (Application-Layer Protocol Negotiation Extension) and\nSNI (Server Name Indication) are TLS handshake extensions:")]),e._v(" "),s("ul",[s("li",[e._v("ALPN: Allows the use of one TLS server for multiple protocols (HTTP, HTTP/2)")]),e._v(" "),s("li",[e._v("SNI: Allows the use of one TLS server for multiple hostnames with different\nSSL certificates.")])]),e._v(" "),s("h3",{attrs:{id:"client-initiated-renegotiation-attack-mitigation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#client-initiated-renegotiation-attack-mitigation"}},[e._v("#")]),e._v(" Client-initiated renegotiation attack mitigation")]),e._v(" "),s("p",[e._v("The TLS protocol allows clients to renegotiate certain aspects of the TLS\nsession. Unfortunately, session renegotiation requires a disproportionate amount\nof server-side resources, making it a potential vector for denial-of-service\nattacks.")]),e._v(" "),s("p",[e._v("To mitigate the risk, renegotiation is limited to three times every ten minutes.\nAn "),s("code",[e._v("'error'")]),e._v(" event is emitted on the "),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v(" instance when this\nthreshold is exceeded. The limits are configurable:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("tls.CLIENT_RENEG_LIMIT")]),e._v(" {number} Specifies the number of renegotiation\nrequests. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("3")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("tls.CLIENT_RENEG_WINDOW")]),e._v(" {number} Specifies the time renegotiation window\nin seconds. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("600")]),e._v(" (10 minutes).")])]),e._v(" "),s("p",[e._v("The default renegotiation limits should not be modified without a full\nunderstanding of the implications and risks.")]),e._v(" "),s("p",[e._v("TLSv1.3 does not support renegotiation.")]),e._v(" "),s("h3",{attrs:{id:"session-resumption"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#session-resumption"}},[e._v("#")]),e._v(" Session Resumption")]),e._v(" "),s("p",[e._v("Establishing a TLS session can be relatively slow. The process can be sped\nup by saving and later reusing the session state. There are several mechanisms\nto do so, discussed here from oldest to newest (and preferred).")]),e._v(" "),s("p",[s("em",[s("strong",[e._v("Session Identifiers")])]),e._v(" Servers generate a unique ID for new connections and\nsend it to the client. Clients and servers save the session state. When\nreconnecting, clients send the ID of their saved session state and if the server\nalso has the state for that ID, it can agree to use it. Otherwise, the server\nwill create a new session. See "),s("a",{attrs:{href:"https://www.ietf.org/rfc/rfc2246.txt",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 2246"),s("OutboundLink")],1),e._v(" for more information, page 23 and\n30.")]),e._v(" "),s("p",[e._v("Resumption using session identifiers is supported by most web browsers when\nmaking HTTPS requests.")]),e._v(" "),s("p",[e._v("For Node.js, clients wait for the "),s("a",{attrs:{href:"#tls_event_session"}},[s("code",[e._v("'session'")])]),e._v(" event to get the session data,\nand provide the data to the "),s("code",[e._v("session")]),e._v(" option of a subsequent "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v("\nto reuse the session. Servers must\nimplement handlers for the "),s("a",{attrs:{href:"#tls_event_newsession"}},[s("code",[e._v("'newSession'")])]),e._v(" and "),s("a",{attrs:{href:"#tls_event_resumesession"}},[s("code",[e._v("'resumeSession'")])]),e._v(" events\nto save and restore the session data using the session ID as the lookup key to\nreuse sessions. To reuse sessions across load balancers or cluster workers,\nservers must use a shared session cache (such as Redis) in their session\nhandlers.")]),e._v(" "),s("p",[s("em",[s("strong",[e._v("Session Tickets")])]),e._v(" The servers encrypt the entire session state and send it\nto the client as a \"ticket\". When reconnecting, the state is sent to the server\nin the initial connection. This mechanism avoids the need for server-side\nsession cache. If the server doesn't use the ticket, for any reason (failure\nto decrypt it, it's too old, etc.), it will create a new session and send a new\nticket. See "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc5077",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 5077"),s("OutboundLink")],1),e._v(" for more information.")]),e._v(" "),s("p",[e._v("Resumption using session tickets is becoming commonly supported by many web\nbrowsers when making HTTPS requests.")]),e._v(" "),s("p",[e._v("For Node.js, clients use the same APIs for resumption with session identifiers\nas for resumption with session tickets. For debugging, if\n"),s("a",{attrs:{href:"#tls_tlssocket_gettlsticket"}},[s("code",[e._v("tls.TLSSocket.getTLSTicket()")])]),e._v(" returns a value, the session data contains a\nticket, otherwise it contains client-side session state.")]),e._v(" "),s("p",[e._v("With TLSv1.3, be aware that multiple tickets may be sent by the server,\nresulting in multiple "),s("code",[e._v("'session'")]),e._v(" events, see "),s("a",{attrs:{href:"#tls_event_session"}},[s("code",[e._v("'session'")])]),e._v(" for more\ninformation.")]),e._v(" "),s("p",[e._v("Single process servers need no specific implementation to use session tickets.\nTo use session tickets across server restarts or load balancers, servers must\nall have the same ticket keys. There are three 16-byte keys internally, but the\ntls API exposes them as a single 48-byte buffer for convenience.")]),e._v(" "),s("p",[e._v("Its possible to get the ticket keys by calling "),s("a",{attrs:{href:"#tls_server_getticketkeys"}},[s("code",[e._v("server.getTicketKeys()")])]),e._v(" on\none server instance and then distribute them, but it is more reasonable to\nsecurely generate 48 bytes of secure random data and set them with the\n"),s("code",[e._v("ticketKeys")]),e._v(" option of "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(". The keys should be regularly\nregenerated and server's keys can be reset with\n"),s("a",{attrs:{href:"#tls_server_setticketkeys_keys"}},[s("code",[e._v("server.setTicketKeys()")])]),e._v(".")]),e._v(" "),s("p",[e._v("Session ticket keys are cryptographic keys, and they "),s("em",[s("strong",[e._v("must be stored\nsecurely")])]),e._v(". With TLS 1.2 and below, if they are compromised all sessions that\nused tickets encrypted with them can be decrypted. They should not be stored\non disk, and they should be regenerated regularly.")]),e._v(" "),s("p",[e._v("If clients advertise support for tickets, the server will send them. The\nserver can disable tickets by supplying\n"),s("code",[e._v("require('constants').SSL_OP_NO_TICKET")]),e._v(" in "),s("code",[e._v("secureOptions")]),e._v(".")]),e._v(" "),s("p",[e._v("Both session identifiers and session tickets timeout, causing the server to\ncreate new sessions. The timeout can be configured with the "),s("code",[e._v("sessionTimeout")]),e._v("\noption of "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(".")]),e._v(" "),s("p",[e._v("For all the mechanisms, when resumption fails, servers will create new sessions.\nSince failing to resume the session does not cause TLS/HTTPS connection\nfailures, it is easy to not notice unnecessarily poor TLS performance. The\nOpenSSL CLI can be used to verify that servers are resuming sessions. Use the\n"),s("code",[e._v("-reconnect")]),e._v(" option to "),s("code",[e._v("openssl s_client")]),e._v(", for example:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("$ openssl s_client -connect localhost:443 -reconnect\n")])])]),s("p",[e._v('Read through the debug output. The first connection should say "New", for\nexample:')]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("New, TLSv1.2, Cipher is ECDHE-RSA-AES128-GCM-SHA256\n")])])]),s("p",[e._v('Subsequent connections should say "Reused", for example:')]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Reused, TLSv1.2, Cipher is ECDHE-RSA-AES128-GCM-SHA256\n")])])]),s("h2",{attrs:{id:"modifying-the-default-tls-cipher-suite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modifying-the-default-tls-cipher-suite"}},[e._v("#")]),e._v(" Modifying the Default TLS Cipher suite")]),e._v(" "),s("p",[e._v("Node.js is built with a default suite of enabled and disabled TLS ciphers.\nCurrently, the default cipher suite is:")]),e._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("TLS_AES_256_GCM_SHA384:\nTLS_CHACHA20_POLY1305_SHA256:\nTLS_AES_128_GCM_SHA256:\nECDHE-RSA-AES128-GCM-SHA256:\nECDHE-ECDSA-AES128-GCM-SHA256:\nECDHE-RSA-AES256-GCM-SHA384:\nECDHE-ECDSA-AES256-GCM-SHA384:\nDHE-RSA-AES128-GCM-SHA256:\nECDHE-RSA-AES128-SHA256:\nDHE-RSA-AES128-SHA256:\nECDHE-RSA-AES256-SHA384:\nDHE-RSA-AES256-SHA384:\nECDHE-RSA-AES256-SHA256:\nDHE-RSA-AES256-SHA256:\nHIGH:\n!aNULL:\n!eNULL:\n!EXPORT:\n!DES:\n!RC4:\n!MD5:\n!PSK:\n!SRP:\n!CAMELLIA\n")])])]),s("p",[e._v("This default can be replaced entirely using the "),s("router-link",{attrs:{to:"/node/cli.html#cli_tls_cipher_list_list"}},[s("code",[e._v("--tls-cipher-list")])]),e._v(" command\nline switch (directly, or via the "),s("router-link",{attrs:{to:"/node/cli.html#cli_node_options_options"}},[s("code",[e._v("NODE_OPTIONS")])]),e._v(" environment variable). For\ninstance, the following makes "),s("code",[e._v("ECDHE-RSA-AES128-GCM-SHA256:!RC4")]),e._v(" the default TLS\ncipher suite:")],1),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("node --tls-cipher-list"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ECDHE-RSA-AES128-GCM-SHA256:!RC4"')]),e._v(" server.js\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("NODE_OPTIONS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("--tls-cipher-list"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ECDHE-RSA-AES128-GCM-SHA256:!RC4"')]),e._v("\nnode server.js\n")])])]),s("p",[e._v("The default can also be replaced on a per client or server basis using the\n"),s("code",[e._v("ciphers")]),e._v(" option from "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(", which is also available\nin "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(", "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(", and when creating new\n"),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v("s.")]),e._v(" "),s("p",[e._v("The ciphers list can contain a mixture of TLSv1.3 cipher suite names, the ones\nthat start with "),s("code",[e._v("'TLS_'")]),e._v(", and specifications for TLSv1.2 and below cipher\nsuites.  The TLSv1.2 ciphers support a legacy specification format, consult\nthe OpenSSL "),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man1/ciphers.html#CIPHER-LIST-FORMAT",target:"_blank",rel:"noopener noreferrer"}},[e._v("cipher list format"),s("OutboundLink")],1),e._v(" documentation for details, but those\nspecifications do "),s("em",[e._v("not")]),e._v(" apply to TLSv1.3 ciphers.  The TLSv1.3 suites can only\nbe enabled by including their full name in the cipher list. They cannot, for\nexample, be enabled or disabled by using the legacy TLSv1.2 "),s("code",[e._v("'EECDH'")]),e._v(" or\n"),s("code",[e._v("'!EECDH'")]),e._v(" specification.")]),e._v(" "),s("p",[e._v("Despite the relative order of TLSv1.3 and TLSv1.2 cipher suites, the TLSv1.3\nprotocol is significantly more secure than TLSv1.2, and will always be chosen\nover TLSv1.2 if the handshake indicates it is supported, and if any TLSv1.3\ncipher suites are enabled.")]),e._v(" "),s("p",[e._v("The default cipher suite included within Node.js has been carefully\nselected to reflect current security best practices and risk mitigation.\nChanging the default cipher suite can have a significant impact on the security\nof an application. The "),s("code",[e._v("--tls-cipher-list")]),e._v(" switch and "),s("code",[e._v("ciphers")]),e._v(" option should by\nused only if absolutely necessary.")]),e._v(" "),s("p",[e._v("The default cipher suite prefers GCM ciphers for "),s("a",{attrs:{href:"https://www.chromium.org/Home/chromium-security/education/tls#TOC-Cipher-Suites",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chrome's 'modern\ncryptography' setting"),s("OutboundLink")],1),e._v(" and also prefers ECDHE and DHE ciphers for Perfect\nForward Secrecy, while offering "),s("em",[e._v("some")]),e._v(" backward compatibility.")]),e._v(" "),s("p",[e._v("128 bit AES is preferred over 192 and 256 bit AES in light of "),s("a",{attrs:{href:"https://www.schneier.com/blog/archives/2009/07/another_new_aes.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("specific\nattacks affecting larger AES key sizes"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Old clients that rely on insecure and deprecated RC4 or DES-based ciphers\n(like Internet Explorer 6) cannot complete the handshaking process with\nthe default configuration. If these clients "),s("em",[e._v("must")]),e._v(" be supported, the\n"),s("a",{attrs:{href:"https://wiki.mozilla.org/Security/Server_Side_TLS",target:"_blank",rel:"noopener noreferrer"}},[e._v("TLS recommendations"),s("OutboundLink")],1),e._v(" may offer a compatible cipher suite. For more details\non the format, see the OpenSSL "),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man1/ciphers.html#CIPHER-LIST-FORMAT",target:"_blank",rel:"noopener noreferrer"}},[e._v("cipher list format"),s("OutboundLink")],1),e._v(" documentation.")]),e._v(" "),s("p",[e._v("There are only 5 TLSv1.3 cipher suites:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("'TLS_AES_256_GCM_SHA384'")])]),e._v(" "),s("li",[s("code",[e._v("'TLS_CHACHA20_POLY1305_SHA256'")])]),e._v(" "),s("li",[s("code",[e._v("'TLS_AES_128_GCM_SHA256'")])]),e._v(" "),s("li",[s("code",[e._v("'TLS_AES_128_CCM_SHA256'")])]),e._v(" "),s("li",[s("code",[e._v("'TLS_AES_128_CCM_8_SHA256'")])])]),e._v(" "),s("p",[e._v("The first 3 are enabled by default. The last 2 "),s("code",[e._v("CCM")]),e._v("-based suites are supported\nby TLSv1.3 because they may be more performant on constrained systems, but they\nare not enabled by default since they offer less security.")]),e._v(" "),s("h2",{attrs:{id:"class-tls-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-tls-server"}},[e._v("#")]),e._v(" Class: tls.Server")]),e._v(" "),s("ul",[s("li",[e._v("Extends: {net.Server}")])]),e._v(" "),s("p",[e._v("Accepts encrypted connections using TLS or SSL.")]),e._v(" "),s("h3",{attrs:{id:"event-keylog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-keylog"}},[e._v("#")]),e._v(" Event: 'keylog'")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("line")]),e._v(" {Buffer} Line of ASCII text, in NSS "),s("code",[e._v("SSLKEYLOGFILE")]),e._v(" format.")]),e._v(" "),s("li",[s("code",[e._v("tlsSocket")]),e._v(" {tls.TLSSocket} The "),s("code",[e._v("tls.TLSSocket")]),e._v(" instance on which it was\ngenerated.")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("keylog")]),e._v(" event is emitted when key material is generated or received by\na connection to this server (typically before handshake has completed, but not\nnecessarily). This keying material can be stored for debugging, as it allows\ncaptured TLS traffic to be decrypted. It may be emitted multiple times for\neach socket.")]),e._v(" "),s("p",[e._v("A typical use case is to append received lines to a common text file, which\nis later used by software (such as Wireshark) to decrypt the traffic:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" logFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("createWriteStream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/tmp/ssl-keys.log'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'a'")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'keylog'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("line"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" tlsSocket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("tlsSocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("remoteAddress "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!==")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'...'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Only log keys for a particular IP")]),e._v("\n  logFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("line"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("h3",{attrs:{id:"event-newsession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-newsession"}},[e._v("#")]),e._v(" Event: 'newSession'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'newSession'")]),e._v(" event is emitted upon creation of a new TLS session. This may\nbe used to store sessions in external storage. The data should be provided to\nthe "),s("a",{attrs:{href:"#tls_event_resumesession"}},[s("code",[e._v("'resumeSession'")])]),e._v(" callback.")]),e._v(" "),s("p",[e._v("The listener callback is passed three arguments when called:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("sessionId")]),e._v(" {Buffer} The TLS session identifier")]),e._v(" "),s("li",[s("code",[e._v("sessionData")]),e._v(" {Buffer} The TLS session data")]),e._v(" "),s("li",[s("code",[e._v("callback")]),e._v(" {Function} A callback function taking no arguments that must be\ninvoked in order for data to be sent or received over the secure connection.")])]),e._v(" "),s("p",[e._v("Listening for this event will have an effect only on connections established\nafter the addition of the event listener.")]),e._v(" "),s("h3",{attrs:{id:"event-ocsprequest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-ocsprequest"}},[e._v("#")]),e._v(" Event: 'OCSPRequest'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'OCSPRequest'")]),e._v(" event is emitted when the client sends a certificate status\nrequest. The listener callback is passed three arguments when called:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("certificate")]),e._v(" {Buffer} The server certificate")]),e._v(" "),s("li",[s("code",[e._v("issuer")]),e._v(" {Buffer} The issuer's certificate")]),e._v(" "),s("li",[s("code",[e._v("callback")]),e._v(" {Function} A callback function that must be invoked to provide\nthe results of the OCSP request.")])]),e._v(" "),s("p",[e._v("The server's current certificate can be parsed to obtain the OCSP URL\nand certificate ID; after obtaining an OCSP response, "),s("code",[e._v("callback(null, resp)")]),e._v(" is\nthen invoked, where "),s("code",[e._v("resp")]),e._v(" is a "),s("code",[e._v("Buffer")]),e._v(" instance containing the OCSP response.\nBoth "),s("code",[e._v("certificate")]),e._v(" and "),s("code",[e._v("issuer")]),e._v(" are "),s("code",[e._v("Buffer")]),e._v(" DER-representations of the\nprimary and issuer's certificates. These can be used to obtain the OCSP\ncertificate ID and OCSP endpoint URL.")]),e._v(" "),s("p",[e._v("Alternatively, "),s("code",[e._v("callback(null, null)")]),e._v(" may be called, indicating that there was\nno OCSP response.")]),e._v(" "),s("p",[e._v("Calling "),s("code",[e._v("callback(err)")]),e._v(" will result in a "),s("code",[e._v("socket.destroy(err)")]),e._v(" call.")]),e._v(" "),s("p",[e._v("The typical flow of an OCSP Request is as follows:")]),e._v(" "),s("ol",[s("li",[e._v("Client connects to the server and sends an "),s("code",[e._v("'OCSPRequest'")]),e._v(" (via the status\ninfo extension in ClientHello).")]),e._v(" "),s("li",[e._v("Server receives the request and emits the "),s("code",[e._v("'OCSPRequest'")]),e._v(" event, calling the\nlistener if registered.")]),e._v(" "),s("li",[e._v("Server extracts the OCSP URL from either the "),s("code",[e._v("certificate")]),e._v(" or "),s("code",[e._v("issuer")]),e._v(" and\nperforms an "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/OCSP_stapling",target:"_blank",rel:"noopener noreferrer"}},[e._v("OCSP request"),s("OutboundLink")],1),e._v(" to the CA.")]),e._v(" "),s("li",[e._v("Server receives "),s("code",[e._v("'OCSPResponse'")]),e._v(" from the CA and sends it back to the client\nvia the "),s("code",[e._v("callback")]),e._v(" argument")]),e._v(" "),s("li",[e._v("Client validates the response and either destroys the socket or performs a\nhandshake.")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("issuer")]),e._v(" can be "),s("code",[e._v("null")]),e._v(" if the certificate is either self-signed or the\nissuer is not in the root certificates list. (An issuer may be provided\nvia the "),s("code",[e._v("ca")]),e._v(" option when establishing the TLS connection.)")]),e._v(" "),s("p",[e._v("Listening for this event will have an effect only on connections established\nafter the addition of the event listener.")]),e._v(" "),s("p",[e._v("An npm module like "),s("a",{attrs:{href:"https://www.npmjs.com/package/asn1.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("asn1.js"),s("OutboundLink")],1),e._v(" may be used to parse the certificates.")]),e._v(" "),s("h3",{attrs:{id:"event-resumesession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-resumesession"}},[e._v("#")]),e._v(" Event: 'resumeSession'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'resumeSession'")]),e._v(" event is emitted when the client requests to resume a\nprevious TLS session. The listener callback is passed two arguments when\ncalled:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("sessionId")]),e._v(" {Buffer} The TLS session identifier")]),e._v(" "),s("li",[s("code",[e._v("callback")]),e._v(" {Function} A callback function to be called when the prior session\nhas been recovered: "),s("code",[e._v("callback([err[, sessionData]])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("err")]),e._v(" {Error}")]),e._v(" "),s("li",[s("code",[e._v("sessionData")]),e._v(" {Buffer}")])])])]),e._v(" "),s("p",[e._v("The event listener should perform a lookup in external storage for the\n"),s("code",[e._v("sessionData")]),e._v(" saved by the "),s("a",{attrs:{href:"#tls_event_newsession"}},[s("code",[e._v("'newSession'")])]),e._v(" event handler using the given\n"),s("code",[e._v("sessionId")]),e._v(". If found, call "),s("code",[e._v("callback(null, sessionData)")]),e._v(" to resume the session.\nIf not found, the session cannot be resumed. "),s("code",[e._v("callback()")]),e._v(" must be called\nwithout "),s("code",[e._v("sessionData")]),e._v(" so that the handshake can continue and a new session can\nbe created. It is possible to call "),s("code",[e._v("callback(err)")]),e._v(" to terminate the incoming\nconnection and destroy the socket.")]),e._v(" "),s("p",[e._v("Listening for this event will have an effect only on connections established\nafter the addition of the event listener.")]),e._v(" "),s("p",[e._v("The following illustrates resuming a TLS session:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" tlsSessionStore "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'newSession'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  tlsSessionStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'hex'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'resumeSession'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("cb")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" tlsSessionStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'hex'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("||")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("h3",{attrs:{id:"event-secureconnection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-secureconnection"}},[e._v("#")]),e._v(" Event: 'secureConnection'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'secureConnection'")]),e._v(" event is emitted after the handshaking process for a\nnew connection has successfully completed. The listener callback is passed a\nsingle argument when called:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("tlsSocket")]),e._v(" {tls.TLSSocket} The established TLS socket.")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tlsSocket.authorized")]),e._v(" property is a "),s("code",[e._v("boolean")]),e._v(" indicating whether the\nclient has been verified by one of the supplied Certificate Authorities for the\nserver. If "),s("code",[e._v("tlsSocket.authorized")]),e._v(" is "),s("code",[e._v("false")]),e._v(", then "),s("code",[e._v("socket.authorizationError")]),e._v("\nis set to describe how authorization failed. Depending on the settings\nof the TLS server, unauthorized connections may still be accepted.")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tlsSocket.alpnProtocol")]),e._v(" property is a string that contains the selected\nALPN protocol. When ALPN has no selected protocol, "),s("code",[e._v("tlsSocket.alpnProtocol")]),e._v("\nequals "),s("code",[e._v("false")]),e._v(".")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tlsSocket.servername")]),e._v(" property is a string containing the server name\nrequested via SNI.")]),e._v(" "),s("h3",{attrs:{id:"event-tlsclienterror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-tlsclienterror"}},[e._v("#")]),e._v(" Event: 'tlsClientError'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'tlsClientError'")]),e._v(" event is emitted when an error occurs before a secure\nconnection is established. The listener callback is passed two arguments when\ncalled:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("exception")]),e._v(" {Error} The "),s("code",[e._v("Error")]),e._v(" object describing the error")]),e._v(" "),s("li",[s("code",[e._v("tlsSocket")]),e._v(" {tls.TLSSocket} The "),s("code",[e._v("tls.TLSSocket")]),e._v(" instance from which the\nerror originated.")])]),e._v(" "),s("h3",{attrs:{id:"server-addcontext-hostname-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-addcontext-hostname-context"}},[e._v("#")]),e._v(" server.addContext(hostname, context)")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("hostname")]),e._v(" {string} A SNI hostname or wildcard (e.g. "),s("code",[e._v("'*'")]),e._v(")")]),e._v(" "),s("li",[s("code",[e._v("context")]),e._v(" {Object} An object containing any of the possible properties\nfrom the "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(" "),s("code",[e._v("options")]),e._v(" arguments (e.g. "),s("code",[e._v("key")]),e._v(",\n"),s("code",[e._v("cert")]),e._v(", "),s("code",[e._v("ca")]),e._v(", etc).")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("server.addContext()")]),e._v(" method adds a secure context that will be used if\nthe client request's SNI name matches the supplied "),s("code",[e._v("hostname")]),e._v(" (or wildcard).")]),e._v(" "),s("h3",{attrs:{id:"server-address"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-address"}},[e._v("#")]),e._v(" server.address()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Object}")])]),e._v(" "),s("p",[e._v("Returns the bound address, the address family name, and port of the\nserver as reported by the operating system. See "),s("router-link",{attrs:{to:"/node/net.html#net_server_address"}},[s("code",[e._v("net.Server.address()")])]),e._v(" for\nmore information.")],1),e._v(" "),s("h3",{attrs:{id:"server-close-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-close-callback"}},[e._v("#")]),e._v(" server.close([callback])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("callback")]),e._v(" {Function} A listener callback that will be registered to listen\nfor the server instance's "),s("code",[e._v("'close'")]),e._v(" event.")]),e._v(" "),s("li",[e._v("Returns: {tls.Server}")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("server.close()")]),e._v(" method stops the server from accepting new connections.")]),e._v(" "),s("p",[e._v("This function operates asynchronously. The "),s("code",[e._v("'close'")]),e._v(" event will be emitted\nwhen the server has no more open connections.")]),e._v(" "),s("h3",{attrs:{id:"server-connections"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-connections"}},[e._v("#")]),e._v(" server.connections")]),e._v(" "),s("blockquote",[s("p",[e._v("Stability: 0 - Deprecated: Use "),s("router-link",{attrs:{to:"/node/net.html#net_server_getconnections_callback"}},[s("code",[e._v("server.getConnections()")])]),e._v(" instead.")],1)]),e._v(" "),s("ul",[s("li",[e._v("{number}")])]),e._v(" "),s("p",[e._v("Returns the current number of concurrent connections on the server.")]),e._v(" "),s("h3",{attrs:{id:"server-getticketkeys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-getticketkeys"}},[e._v("#")]),e._v(" server.getTicketKeys()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Buffer} A 48-byte buffer containing the session ticket keys.")])]),e._v(" "),s("p",[e._v("Returns the session ticket keys.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("h3",{attrs:{id:"server-listen"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-listen"}},[e._v("#")]),e._v(" server.listen()")]),e._v(" "),s("p",[e._v("Starts the server listening for encrypted connections.\nThis method is identical to "),s("router-link",{attrs:{to:"/node/net.html#net_server_listen"}},[s("code",[e._v("server.listen()")])]),e._v(" from "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_server"}},[s("code",[e._v("net.Server")])]),e._v(".")],1),e._v(" "),s("h3",{attrs:{id:"server-setsecurecontext-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-setsecurecontext-options"}},[e._v("#")]),e._v(" server.setSecureContext(options)")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("options")]),e._v(" {Object} An object containing any of the possible properties from\nthe "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(" "),s("code",[e._v("options")]),e._v(" arguments (e.g. "),s("code",[e._v("key")]),e._v(", "),s("code",[e._v("cert")]),e._v(",\n"),s("code",[e._v("ca")]),e._v(", etc).")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("server.setSecureContext()")]),e._v(" method replaces the secure context of an\nexisting server. Existing connections to the server are not interrupted.")]),e._v(" "),s("h3",{attrs:{id:"server-setticketkeys-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-setticketkeys-keys"}},[e._v("#")]),e._v(" server.setTicketKeys(keys)")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("keys")]),e._v(" {Buffer} A 48-byte buffer containing the session ticket keys.")])]),e._v(" "),s("p",[e._v("Sets the session ticket keys.")]),e._v(" "),s("p",[e._v("Changes to the ticket keys are effective only for future server connections.\nExisting or currently pending server connections will use the previous keys.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("h2",{attrs:{id:"class-tls-tlssocket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-tls-tlssocket"}},[e._v("#")]),e._v(" Class: tls.TLSSocket")]),e._v(" "),s("ul",[s("li",[e._v("Extends: {net.Socket}")])]),e._v(" "),s("p",[e._v("Performs transparent encryption of written data and all required TLS\nnegotiation.")]),e._v(" "),s("p",[e._v("Instances of "),s("code",[e._v("tls.TLSSocket")]),e._v(" implement the duplex "),s("router-link",{attrs:{to:"/node/stream.html#stream_stream"}},[e._v("Stream")]),e._v(" interface.")],1),e._v(" "),s("p",[e._v("Methods that return TLS connection metadata (e.g.\n"),s("a",{attrs:{href:"#tls_tlssocket_getpeercertificate_detailed"}},[s("code",[e._v("tls.TLSSocket.getPeerCertificate()")])]),e._v(" will only return data while the\nconnection is open.")]),e._v(" "),s("h3",{attrs:{id:"new-tls-tlssocket-socket-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#new-tls-tlssocket-socket-options"}},[e._v("#")]),e._v(" new tls.TLSSocket(socket[, options])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("socket")]),e._v(" {net.Socket|stream.Duplex}\nOn the server side, any "),s("code",[e._v("Duplex")]),e._v(" stream. On the client side, any\ninstance of "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_socket"}},[s("code",[e._v("net.Socket")])]),e._v(" (for generic "),s("code",[e._v("Duplex")]),e._v(" stream support\non the client side, "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(" must be used).")],1),e._v(" "),s("li",[s("code",[e._v("options")]),e._v(" {Object}\n"),s("ul",[s("li",[s("code",[e._v("enableTrace")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("isServer")]),e._v(": The SSL/TLS protocol is asymmetrical, TLSSockets must know if\nthey are to behave as a server or a client. If "),s("code",[e._v("true")]),e._v(" the TLS socket will be\ninstantiated as a server. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("false")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("server")]),e._v(" {net.Server} A "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_server"}},[s("code",[e._v("net.Server")])]),e._v(" instance.")],1),e._v(" "),s("li",[s("code",[e._v("requestCert")]),e._v(": Whether to authenticate the remote peer by requesting a\ncertificate. Clients always request a server certificate. Servers\n("),s("code",[e._v("isServer")]),e._v(" is true) may set "),s("code",[e._v("requestCert")]),e._v(" to true to request a client\ncertificate.")]),e._v(" "),s("li",[s("code",[e._v("rejectUnauthorized")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("ALPNProtocols")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("SNICallback")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("session")]),e._v(" {Buffer} A "),s("code",[e._v("Buffer")]),e._v(" instance containing a TLS session.")]),e._v(" "),s("li",[s("code",[e._v("requestOCSP")]),e._v(" {boolean} If "),s("code",[e._v("true")]),e._v(", specifies that the OCSP status request\nextension will be added to the client hello and an "),s("code",[e._v("'OCSPResponse'")]),e._v(" event\nwill be emitted on the socket before establishing a secure communication")]),e._v(" "),s("li",[s("code",[e._v("secureContext")]),e._v(": TLS context object created with\n"),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(". If a "),s("code",[e._v("secureContext")]),e._v(" is "),s("em",[e._v("not")]),e._v(" provided, one\nwill be created by passing the entire "),s("code",[e._v("options")]),e._v(" object to\n"),s("code",[e._v("tls.createSecureContext()")]),e._v(".")]),e._v(" "),s("li",[e._v("...: "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(" options that are used if the\n"),s("code",[e._v("secureContext")]),e._v(" option is missing. Otherwise, they are ignored.")])])])]),e._v(" "),s("p",[e._v("Construct a new "),s("code",[e._v("tls.TLSSocket")]),e._v(" object from an existing TCP socket.")]),e._v(" "),s("h3",{attrs:{id:"event-keylog-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-keylog-2"}},[e._v("#")]),e._v(" Event: 'keylog'")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("line")]),e._v(" {Buffer} Line of ASCII text, in NSS "),s("code",[e._v("SSLKEYLOGFILE")]),e._v(" format.")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("keylog")]),e._v(" event is emitted on a client "),s("code",[e._v("tls.TLSSocket")]),e._v(" when key material\nis generated or received by the socket. This keying material can be stored\nfor debugging, as it allows captured TLS traffic to be decrypted. It may\nbe emitted multiple times, before or after the handshake completes.")]),e._v(" "),s("p",[e._v("A typical use case is to append received lines to a common text file, which\nis later used by software (such as Wireshark) to decrypt the traffic:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" logFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("createWriteStream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/tmp/ssl-keys.log'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'a'")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ...")]),e._v("\ntlsSocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'keylog'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("line")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" logFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("line"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("h3",{attrs:{id:"event-ocspresponse"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-ocspresponse"}},[e._v("#")]),e._v(" Event: 'OCSPResponse'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'OCSPResponse'")]),e._v(" event is emitted if the "),s("code",[e._v("requestOCSP")]),e._v(" option was set\nwhen the "),s("code",[e._v("tls.TLSSocket")]),e._v(" was created and an OCSP response has been received.\nThe listener callback is passed a single argument when called:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("response")]),e._v(" {Buffer} The server's OCSP response")])]),e._v(" "),s("p",[e._v("Typically, the "),s("code",[e._v("response")]),e._v(" is a digitally signed object from the server's CA that\ncontains information about server's certificate revocation status.")]),e._v(" "),s("h3",{attrs:{id:"event-secureconnect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-secureconnect"}},[e._v("#")]),e._v(" Event: 'secureConnect'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'secureConnect'")]),e._v(" event is emitted after the handshaking process for a new\nconnection has successfully completed. The listener callback will be called\nregardless of whether or not the server's certificate has been authorized. It\nis the client's responsibility to check the "),s("code",[e._v("tlsSocket.authorized")]),e._v(" property to\ndetermine if the server certificate was signed by one of the specified CAs. If\n"),s("code",[e._v("tlsSocket.authorized === false")]),e._v(", then the error can be found by examining the\n"),s("code",[e._v("tlsSocket.authorizationError")]),e._v(" property. If ALPN was used, the\n"),s("code",[e._v("tlsSocket.alpnProtocol")]),e._v(" property can be checked to determine the negotiated\nprotocol.")]),e._v(" "),s("h3",{attrs:{id:"event-session"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-session"}},[e._v("#")]),e._v(" Event: 'session'")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("session")]),e._v(" {Buffer}")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'session'")]),e._v(" event is emitted on a client "),s("code",[e._v("tls.TLSSocket")]),e._v(" when a new session\nor TLS ticket is available. This may or may not be before the handshake is\ncomplete, depending on the TLS protocol version that was negotiated. The event\nis not emitted on the server, or if a new session was not created, for example,\nwhen the connection was resumed. For some TLS protocol versions the event may be\nemitted multiple times, in which case all the sessions can be used for\nresumption.")]),e._v(" "),s("p",[e._v("On the client, the "),s("code",[e._v("session")]),e._v(" can be provided to the "),s("code",[e._v("session")]),e._v(" option of\n"),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(" to resume the connection.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("p",[e._v("Note: For TLSv1.2 and below, "),s("a",{attrs:{href:"#tls_tlssocket_getsession"}},[s("code",[e._v("tls.TLSSocket.getSession()")])]),e._v(" can be called once\nthe handshake is complete.  For TLSv1.3, only ticket based resumption is allowed\nby the protocol, multiple tickets are sent, and the tickets aren't sent until\nlater, after the handshake completes, so it is necessary to wait for the\n"),s("code",[e._v("'session'")]),e._v(" event to get a resumable session.  Applications are\nrecommended to use the "),s("code",[e._v("'session'")]),e._v(" event instead of "),s("code",[e._v("getSession()")]),e._v(" to ensure\nthey will work for all TLS protocol versions.  Applications that only expect to\nget or use 1 session should listen for this event only once:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("tlsSocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("once")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'session'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("session")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// The session can be used immediately or later.")]),e._v("\n  tls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Other connect options...")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("h3",{attrs:{id:"tlssocket-address"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-address"}},[e._v("#")]),e._v(" tlsSocket.address()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Object}")])]),e._v(" "),s("p",[e._v("Returns the bound "),s("code",[e._v("address")]),e._v(", the address "),s("code",[e._v("family")]),e._v(" name, and "),s("code",[e._v("port")]),e._v(" of the\nunderlying socket as reported by the operating system:\n"),s("code",[e._v("{ port: 12346, family: 'IPv4', address: '127.0.0.1' }")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-authorizationerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-authorizationerror"}},[e._v("#")]),e._v(" tlsSocket.authorizationError")]),e._v(" "),s("p",[e._v("Returns the reason why the peer's certificate was not been verified. This\nproperty is set only when "),s("code",[e._v("tlsSocket.authorized === false")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-authorized"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-authorized"}},[e._v("#")]),e._v(" tlsSocket.authorized")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {boolean}")])]),e._v(" "),s("p",[e._v("Returns "),s("code",[e._v("true")]),e._v(" if the peer certificate was signed by one of the CAs specified\nwhen creating the "),s("code",[e._v("tls.TLSSocket")]),e._v(" instance, otherwise "),s("code",[e._v("false")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-disablerenegotiation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-disablerenegotiation"}},[e._v("#")]),e._v(" tlsSocket.disableRenegotiation()")]),e._v(" "),s("p",[e._v("Disables TLS renegotiation for this "),s("code",[e._v("TLSSocket")]),e._v(" instance. Once called, attempts\nto renegotiate will trigger an "),s("code",[e._v("'error'")]),e._v(" event on the "),s("code",[e._v("TLSSocket")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-enabletrace"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-enabletrace"}},[e._v("#")]),e._v(" tlsSocket.enableTrace()")]),e._v(" "),s("p",[e._v("When enabled, TLS packet trace information is written to "),s("code",[e._v("stderr")]),e._v(". This can be\nused to debug TLS connection problems.")]),e._v(" "),s("p",[e._v("Note: The format of the output is identical to the output of "),s("code",[e._v("openssl s_client -trace")]),e._v(" or "),s("code",[e._v("openssl s_server -trace")]),e._v(". While it is produced by OpenSSL's\n"),s("code",[e._v("SSL_trace()")]),e._v(" function, the format is undocumented, can change without notice,\nand should not be relied on.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-encrypted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-encrypted"}},[e._v("#")]),e._v(" tlsSocket.encrypted")]),e._v(" "),s("p",[e._v("Always returns "),s("code",[e._v("true")]),e._v(". This may be used to distinguish TLS sockets from regular\n"),s("code",[e._v("net.Socket")]),e._v(" instances.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getcertificate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getcertificate"}},[e._v("#")]),e._v(" tlsSocket.getCertificate()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Object}")])]),e._v(" "),s("p",[e._v("Returns an object representing the local certificate. The returned object has\nsome properties corresponding to the fields of the certificate.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_tlssocket_getpeercertificate_detailed"}},[s("code",[e._v("tls.TLSSocket.getPeerCertificate()")])]),e._v(" for an example of the certificate\nstructure.")]),e._v(" "),s("p",[e._v("If there is no local certificate, an empty object will be returned. If the\nsocket has been destroyed, "),s("code",[e._v("null")]),e._v(" will be returned.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getcipher"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getcipher"}},[e._v("#")]),e._v(" tlsSocket.getCipher()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Object}\n"),s("ul",[s("li",[s("code",[e._v("name")]),e._v(" {string} The name of the cipher suite.")]),e._v(" "),s("li",[s("code",[e._v("version")]),e._v(" {string} The minimum TLS protocol version supported by this cipher\nsuite.")])])])]),e._v(" "),s("p",[e._v("Returns an object containing information on the negotiated cipher suite.")]),e._v(" "),s("p",[e._v("For example: "),s("code",[e._v("{ name: 'AES256-SHA', version: 'TLSv1.2' }")]),e._v(".")]),e._v(" "),s("p",[e._v("See\n"),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man3/SSL_CIPHER_get_name.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSL_CIPHER_get_name"),s("OutboundLink")],1),e._v("\nfor more information.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getephemeralkeyinfo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getephemeralkeyinfo"}},[e._v("#")]),e._v(" tlsSocket.getEphemeralKeyInfo()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Object}")])]),e._v(" "),s("p",[e._v("Returns an object representing the type, name, and size of parameter of\nan ephemeral key exchange in "),s("a",{attrs:{href:"#tls_perfect_forward_secrecy"}},[e._v("Perfect Forward Secrecy")]),e._v(" on a client\nconnection. It returns an empty object when the key exchange is not\nephemeral. As this is only supported on a client socket; "),s("code",[e._v("null")]),e._v(" is returned\nif called on a server socket. The supported types are "),s("code",[e._v("'DH'")]),e._v(" and "),s("code",[e._v("'ECDH'")]),e._v(". The\n"),s("code",[e._v("name")]),e._v(" property is available only when type is "),s("code",[e._v("'ECDH'")]),e._v(".")]),e._v(" "),s("p",[e._v("For example: "),s("code",[e._v("{ type: 'ECDH', name: 'prime256v1', size: 256 }")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getfinished"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getfinished"}},[e._v("#")]),e._v(" tlsSocket.getFinished()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Buffer|undefined} The latest "),s("code",[e._v("Finished")]),e._v(" message that has been\nsent to the socket as part of a SSL/TLS handshake, or "),s("code",[e._v("undefined")]),e._v(" if\nno "),s("code",[e._v("Finished")]),e._v(" message has been sent yet.")])]),e._v(" "),s("p",[e._v("As the "),s("code",[e._v("Finished")]),e._v(" messages are message digests of the complete handshake\n(with a total of 192 bits for TLS 1.0 and more for SSL 3.0), they can\nbe used for external authentication procedures when the authentication\nprovided by SSL/TLS is not desired or is not enough.")]),e._v(" "),s("p",[e._v("Corresponds to the "),s("code",[e._v("SSL_get_finished")]),e._v(" routine in OpenSSL and may be used\nto implement the "),s("code",[e._v("tls-unique")]),e._v(" channel binding from "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc5929",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 5929"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getpeercertificate-detailed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getpeercertificate-detailed"}},[e._v("#")]),e._v(" tlsSocket.getPeerCertificate([detailed])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("detailed")]),e._v(" {boolean} Include the full certificate chain if "),s("code",[e._v("true")]),e._v(", otherwise\ninclude just the peer's certificate.")]),e._v(" "),s("li",[e._v("Returns: {Object} A certificate object.")])]),e._v(" "),s("p",[e._v("Returns an object representing the peer's certificate. If the peer does not\nprovide a certificate, an empty object will be returned. If the socket has been\ndestroyed, "),s("code",[e._v("null")]),e._v(" will be returned.")]),e._v(" "),s("p",[e._v("If the full certificate chain was requested, each certificate will include an\n"),s("code",[e._v("issuerCertificate")]),e._v(" property containing an object representing its issuer's\ncertificate.")]),e._v(" "),s("h4",{attrs:{id:"certificate-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#certificate-object"}},[e._v("#")]),e._v(" Certificate Object")]),e._v(" "),s("p",[e._v("A certificate object has properties corresponding to the fields of the\ncertificate.")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("raw")]),e._v(" {Buffer} The DER encoded X.509 certificate data.")]),e._v(" "),s("li",[s("code",[e._v("subject")]),e._v(" {Object} The certificate subject, described in terms of\nCountry ("),s("code",[e._v("C:")]),e._v("), StateOrProvince ("),s("code",[e._v("ST")]),e._v("), Locality ("),s("code",[e._v("L")]),e._v("), Organization ("),s("code",[e._v("O")]),e._v("),\nOrganizationalUnit ("),s("code",[e._v("OU")]),e._v("), and CommonName ("),s("code",[e._v("CN")]),e._v("). The CommonName is typically\na DNS name with TLS certificates. Example:\n"),s("code",[e._v("{C: 'UK', ST: 'BC', L: 'Metro', O: 'Node Fans', OU: 'Docs', CN: 'example.com'}")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("issuer")]),e._v(" {Object} The certificate issuer, described in the same terms as the\n"),s("code",[e._v("subject")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("valid_from")]),e._v(" {string} The date-time the certificate is valid from.")]),e._v(" "),s("li",[s("code",[e._v("valid_to")]),e._v(" {string} The date-time the certificate is valid to.")]),e._v(" "),s("li",[s("code",[e._v("serialNumber")]),e._v(" {string} The certificate serial number, as a hex string.\nExample: "),s("code",[e._v("'B9B0D332A1AA5635'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("fingerprint")]),e._v(" {string} The SHA-1 digest of the DER encoded certificate. It is\nreturned as a "),s("code",[e._v(":")]),e._v(" separated hexadecimal string. Example: "),s("code",[e._v("'2A:7A:C2:DD:...'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("fingerprint256")]),e._v(" {string} The SHA-256 digest of the DER encoded certificate.\nIt is returned as a "),s("code",[e._v(":")]),e._v(" separated hexadecimal string. Example:\n"),s("code",[e._v("'2A:7A:C2:DD:...'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("ext_key_usage")]),e._v(" {Array} (Optional) The extended key usage, a set of OIDs.")]),e._v(" "),s("li",[s("code",[e._v("subjectaltname")]),e._v(" {string} (Optional) A string containing concatenated names\nfor the subject, an alternative to the "),s("code",[e._v("subject")]),e._v(" names.")]),e._v(" "),s("li",[s("code",[e._v("infoAccess")]),e._v(" {Array} (Optional) An array describing the AuthorityInfoAccess,\nused with OCSP.")]),e._v(" "),s("li",[s("code",[e._v("issuerCertificate")]),e._v(" {Object} (Optional) The issuer certificate object. For\nself-signed certificates, this may be a circular reference.")])]),e._v(" "),s("p",[e._v("The certificate may contain information about the public key, depending on\nthe key type.")]),e._v(" "),s("p",[e._v("For RSA keys, the following properties may be defined:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("bits")]),e._v(" {number} The RSA bit size. Example: "),s("code",[e._v("1024")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("exponent")]),e._v(" {string} The RSA exponent, as a string in hexadecimal number\nnotation. Example: "),s("code",[e._v("'0x010001'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("modulus")]),e._v(" {string} The RSA modulus, as a hexadecimal string. Example:\n"),s("code",[e._v("'B56CE45CB7...'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("pubkey")]),e._v(" {Buffer} The public key.")])]),e._v(" "),s("p",[e._v("For EC keys, the following properties may be defined:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("pubkey")]),e._v(" {Buffer} The public key.")]),e._v(" "),s("li",[s("code",[e._v("bits")]),e._v(" {number} The key size in bits. Example: "),s("code",[e._v("256")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("asn1Curve")]),e._v(" {string} (Optional) The ASN.1 name of the OID of the elliptic\ncurve. Well-known curves are identified by an OID. While it is unusual, it is\npossible that the curve is identified by its mathematical properties, in which\ncase it will not have an OID. Example: "),s("code",[e._v("'prime256v1'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("nistCurve")]),e._v(" {string} (Optional) The NIST name for the elliptic curve, if it\nhas one (not all well-known curves have been assigned names by NIST). Example:\n"),s("code",[e._v("'P-256'")]),e._v(".")])]),e._v(" "),s("p",[e._v("Example certificate:")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("{ subject:\n   { OU: [ 'Domain Control Validated', 'PositiveSSL Wildcard' ],\n     CN: '*.nodejs.org' },\n  issuer:\n   { C: 'GB',\n     ST: 'Greater Manchester',\n     L: 'Salford',\n     O: 'COMODO CA Limited',\n     CN: 'COMODO RSA Domain Validation Secure Server CA' },\n  subjectaltname: 'DNS:*.nodejs.org, DNS:nodejs.org',\n  infoAccess:\n   { 'CA Issuers - URI':\n      [ 'http://crt.comodoca.com/COMODORSADomainValidationSecureServerCA.crt' ],\n     'OCSP - URI': [ 'http://ocsp.comodoca.com' ] },\n  modulus: 'B56CE45CB740B09A13F64AC543B712FF9EE8E4C284B542A1708A27E82A8D151CA178153E12E6DDA15BF70FFD96CB8A88618641BDFCCA03527E665B70D779C8A349A6F88FD4EF6557180BD4C98192872BCFE3AF56E863C09DDD8BC1EC58DF9D94F914F0369102B2870BECFA1348A0838C9C49BD1C20124B442477572347047506B1FCD658A80D0C44BCC16BC5C5496CFE6E4A8428EF654CD3D8972BF6E5BFAD59C93006830B5EB1056BBB38B53D1464FA6E02BFDF2FF66CD949486F0775EC43034EC2602AEFBF1703AD221DAA2A88353C3B6A688EFE8387811F645CEED7B3FE46E1F8B9F59FAD028F349B9BC14211D5830994D055EEA3D547911E07A0ADDEB8A82B9188E58720D95CD478EEC9AF1F17BE8141BE80906F1A339445A7EB5B285F68039B0F294598A7D1C0005FC22B5271B0752F58CCDEF8C8FD856FB7AE21C80B8A2CE983AE94046E53EDE4CB89F42502D31B5360771C01C80155918637490550E3F555E2EE75CC8C636DDE3633CFEDD62E91BF0F7688273694EEEBA20C2FC9F14A2A435517BC1D7373922463409AB603295CEB0BB53787A334C9CA3CA8B30005C5A62FC0715083462E00719A8FA3ED0A9828C3871360A73F8B04A4FC1E71302844E9BB9940B77E745C9D91F226D71AFCAD4B113AAF68D92B24DDB4A2136B55A1CD1ADF39605B63CB639038ED0F4C987689866743A68769CC55847E4A06D6E2E3F1',\n  exponent: '0x10001',\n  pubkey: <Buffer ... >,\n  valid_from: 'Aug 14 00:00:00 2017 GMT',\n  valid_to: 'Nov 20 23:59:59 2019 GMT',\n  fingerprint: '01:02:59:D9:C3:D2:0D:08:F7:82:4E:44:A4:B4:53:C5:E2:3A:87:4D',\n  fingerprint256: '69:AE:1A:6A:D4:3D:C6:C1:1B:EA:C6:23:DE:BA:2A:14:62:62:93:5C:7A:EA:06:41:9B:0B:BC:87:CE:48:4E:02',\n  ext_key_usage: [ '1.3.6.1.5.5.7.3.1', '1.3.6.1.5.5.7.3.2' ],\n  serialNumber: '66593D57F20CBC573E433381B5FEC280',\n  raw: <Buffer ... > }\n")])])]),s("h3",{attrs:{id:"tlssocket-getpeerfinished"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getpeerfinished"}},[e._v("#")]),e._v(" tlsSocket.getPeerFinished()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Buffer|undefined} The latest "),s("code",[e._v("Finished")]),e._v(" message that is expected\nor has actually been received from the socket as part of a SSL/TLS handshake,\nor "),s("code",[e._v("undefined")]),e._v(" if there is no "),s("code",[e._v("Finished")]),e._v(" message so far.")])]),e._v(" "),s("p",[e._v("As the "),s("code",[e._v("Finished")]),e._v(" messages are message digests of the complete handshake\n(with a total of 192 bits for TLS 1.0 and more for SSL 3.0), they can\nbe used for external authentication procedures when the authentication\nprovided by SSL/TLS is not desired or is not enough.")]),e._v(" "),s("p",[e._v("Corresponds to the "),s("code",[e._v("SSL_get_peer_finished")]),e._v(" routine in OpenSSL and may be used\nto implement the "),s("code",[e._v("tls-unique")]),e._v(" channel binding from "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc5929",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 5929"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getprotocol"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getprotocol"}},[e._v("#")]),e._v(" tlsSocket.getProtocol()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {string|null}")])]),e._v(" "),s("p",[e._v("Returns a string containing the negotiated SSL/TLS protocol version of the\ncurrent connection. The value "),s("code",[e._v("'unknown'")]),e._v(" will be returned for connected\nsockets that have not completed the handshaking process. The value "),s("code",[e._v("null")]),e._v(" will\nbe returned for server sockets or disconnected client sockets.")]),e._v(" "),s("p",[e._v("Protocol versions are:")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("'SSLv3'")])]),e._v(" "),s("li",[s("code",[e._v("'TLSv1'")])]),e._v(" "),s("li",[s("code",[e._v("'TLSv1.1'")])]),e._v(" "),s("li",[s("code",[e._v("'TLSv1.2'")])]),e._v(" "),s("li",[s("code",[e._v("'TLSv1.3'")])])]),e._v(" "),s("p",[e._v("See the OpenSSL "),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man3/SSL_get_version.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("SSL_get_version")]),s("OutboundLink")],1),e._v(" documentation for more information.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getsession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getsession"}},[e._v("#")]),e._v(" tlsSocket.getSession()")]),e._v(" "),s("ul",[s("li",[e._v("{Buffer}")])]),e._v(" "),s("p",[e._v("Returns the TLS session data or "),s("code",[e._v("undefined")]),e._v(" if no session was\nnegotiated. On the client, the data can be provided to the "),s("code",[e._v("session")]),e._v(" option of\n"),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(" to resume the connection. On the server, it may be useful\nfor debugging.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("p",[e._v("Note: "),s("code",[e._v("getSession()")]),e._v(" works only for TLSv1.2 and below. For TLSv1.3, applications\nmust use the "),s("a",{attrs:{href:"#tls_event_session"}},[s("code",[e._v("'session'")])]),e._v(" event (it also works for TLSv1.2 and below).")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-getsharedsigalgs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-getsharedsigalgs"}},[e._v("#")]),e._v(" tlsSocket.getSharedSigalgs()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {Array} List of signature algorithms shared between the server and\nthe client in the order of decreasing preference.")])]),e._v(" "),s("p",[e._v("See\n"),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man3/SSL_get_shared_sigalgs.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSL_get_shared_sigalgs"),s("OutboundLink")],1),e._v("\nfor more information.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-gettlsticket"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-gettlsticket"}},[e._v("#")]),e._v(" tlsSocket.getTLSTicket()")]),e._v(" "),s("ul",[s("li",[e._v("{Buffer}")])]),e._v(" "),s("p",[e._v("For a client, returns the TLS session ticket if one is available, or\n"),s("code",[e._v("undefined")]),e._v(". For a server, always returns "),s("code",[e._v("undefined")]),e._v(".")]),e._v(" "),s("p",[e._v("It may be useful for debugging.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-issessionreused"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-issessionreused"}},[e._v("#")]),e._v(" tlsSocket.isSessionReused()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {boolean} "),s("code",[e._v("true")]),e._v(" if the session was reused, "),s("code",[e._v("false")]),e._v(" otherwise.")])]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-localaddress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-localaddress"}},[e._v("#")]),e._v(" tlsSocket.localAddress")]),e._v(" "),s("ul",[s("li",[e._v("{string}")])]),e._v(" "),s("p",[e._v("Returns the string representation of the local IP address.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-localport"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-localport"}},[e._v("#")]),e._v(" tlsSocket.localPort")]),e._v(" "),s("ul",[s("li",[e._v("{number}")])]),e._v(" "),s("p",[e._v("Returns the numeric representation of the local port.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-remoteaddress"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-remoteaddress"}},[e._v("#")]),e._v(" tlsSocket.remoteAddress")]),e._v(" "),s("ul",[s("li",[e._v("{string}")])]),e._v(" "),s("p",[e._v("Returns the string representation of the remote IP address. For example,\n"),s("code",[e._v("'74.125.127.100'")]),e._v(" or "),s("code",[e._v("'2001:4860:a005::68'")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-remotefamily"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-remotefamily"}},[e._v("#")]),e._v(" tlsSocket.remoteFamily")]),e._v(" "),s("ul",[s("li",[e._v("{string}")])]),e._v(" "),s("p",[e._v("Returns the string representation of the remote IP family. "),s("code",[e._v("'IPv4'")]),e._v(" or "),s("code",[e._v("'IPv6'")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-remoteport"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-remoteport"}},[e._v("#")]),e._v(" tlsSocket.remotePort")]),e._v(" "),s("ul",[s("li",[e._v("{number}")])]),e._v(" "),s("p",[e._v("Returns the numeric representation of the remote port. For example, "),s("code",[e._v("443")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-renegotiate-options-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-renegotiate-options-callback"}},[e._v("#")]),e._v(" tlsSocket.renegotiate(options, callback)")]),e._v(" "),s("ul",[s("li",[s("p",[s("code",[e._v("options")]),e._v(" {Object}")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("rejectUnauthorized")]),e._v(" {boolean} If not "),s("code",[e._v("false")]),e._v(", the server certificate is\nverified against the list of supplied CAs. An "),s("code",[e._v("'error'")]),e._v(" event is emitted if\nverification fails; "),s("code",[e._v("err.code")]),e._v(" contains the OpenSSL error code. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("true")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("requestCert")])])])]),e._v(" "),s("li",[s("p",[s("code",[e._v("callback")]),e._v(" {Function} If "),s("code",[e._v("renegotiate()")]),e._v(" returned "),s("code",[e._v("true")]),e._v(", callback is\nattached once to the "),s("code",[e._v("'secure'")]),e._v(" event. If "),s("code",[e._v("renegotiate()")]),e._v(" returned "),s("code",[e._v("false")]),e._v(",\n"),s("code",[e._v("callback")]),e._v(" will be called in the next tick with an error, unless the\n"),s("code",[e._v("tlsSocket")]),e._v(" has been destroyed, in which case "),s("code",[e._v("callback")]),e._v(" will not be called\nat all.")])]),e._v(" "),s("li",[s("p",[e._v("Returns: {boolean} "),s("code",[e._v("true")]),e._v(" if renegotiation was initiated, "),s("code",[e._v("false")]),e._v(" otherwise.")])])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tlsSocket.renegotiate()")]),e._v(" method initiates a TLS renegotiation process.\nUpon completion, the "),s("code",[e._v("callback")]),e._v(" function will be passed a single argument\nthat is either an "),s("code",[e._v("Error")]),e._v(" (if the request failed) or "),s("code",[e._v("null")]),e._v(".")]),e._v(" "),s("p",[e._v("This method can be used to request a peer's certificate after the secure\nconnection has been established.")]),e._v(" "),s("p",[e._v("When running as the server, the socket will be destroyed with an error after\n"),s("code",[e._v("handshakeTimeout")]),e._v(" timeout.")]),e._v(" "),s("p",[e._v("For TLSv1.3, renegotiation cannot be initiated, it is not supported by the\nprotocol.")]),e._v(" "),s("h3",{attrs:{id:"tlssocket-setmaxsendfragment-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tlssocket-setmaxsendfragment-size"}},[e._v("#")]),e._v(" tlsSocket.setMaxSendFragment(size)")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("size")]),e._v(" {number} The maximum TLS fragment size. The maximum value is "),s("code",[e._v("16384")]),e._v(".\n"),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("16384")]),e._v(".")]),e._v(" "),s("li",[e._v("Returns: {boolean}")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tlsSocket.setMaxSendFragment()")]),e._v(" method sets the maximum TLS fragment size.\nReturns "),s("code",[e._v("true")]),e._v(" if setting the limit succeeded; "),s("code",[e._v("false")]),e._v(" otherwise.")]),e._v(" "),s("p",[e._v("Smaller fragment sizes decrease the buffering latency on the client: larger\nfragments are buffered by the TLS layer until the entire fragment is received\nand its integrity is verified; large fragments can span multiple roundtrips\nand their processing can be delayed due to packet loss or reordering. However,\nsmaller fragments add extra TLS framing bytes and CPU overhead, which may\ndecrease overall server throughput.")]),e._v(" "),s("h2",{attrs:{id:"tls-checkserveridentity-hostname-cert"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-checkserveridentity-hostname-cert"}},[e._v("#")]),e._v(" tls.checkServerIdentity(hostname, cert)")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("hostname")]),e._v(" {string} The host name or IP address to verify the certificate\nagainst.")]),e._v(" "),s("li",[s("code",[e._v("cert")]),e._v(" {Object} A "),s("a",{attrs:{href:"#tls_certificate_object"}},[e._v("certificate object")]),e._v(" representing the peer's certificate.")]),e._v(" "),s("li",[e._v("Returns: {Error|undefined}")])]),e._v(" "),s("p",[e._v("Verifies the certificate "),s("code",[e._v("cert")]),e._v(" is issued to "),s("code",[e._v("hostname")]),e._v(".")]),e._v(" "),s("p",[e._v("Returns {Error} object, populating it with "),s("code",[e._v("reason")]),e._v(", "),s("code",[e._v("host")]),e._v(", and "),s("code",[e._v("cert")]),e._v(" on\nfailure. On success, returns {undefined}.")]),e._v(" "),s("p",[e._v("This function can be overwritten by providing alternative function as part of\nthe "),s("code",[e._v("options.checkServerIdentity")]),e._v(" option passed to "),s("code",[e._v("tls.connect()")]),e._v(". The\noverwriting function can call "),s("code",[e._v("tls.checkServerIdentity()")]),e._v(" of course, to augment\nthe checks done with additional verification.")]),e._v(" "),s("p",[e._v("This function is only called if the certificate passed all other checks, such as\nbeing issued by trusted CA ("),s("code",[e._v("options.ca")]),e._v(").")]),e._v(" "),s("h2",{attrs:{id:"tls-connect-options-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-connect-options-callback"}},[e._v("#")]),e._v(" tls.connect(options[, callback])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("options")]),e._v(" {Object}\n"),s("ul",[s("li",[s("code",[e._v("enableTrace")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("host")]),e._v(" {string} Host the client should connect to. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("'localhost'")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("port")]),e._v(" {number} Port the client should connect to.")]),e._v(" "),s("li",[s("code",[e._v("path")]),e._v(" {string} Creates Unix socket connection to path. If this option is\nspecified, "),s("code",[e._v("host")]),e._v(" and "),s("code",[e._v("port")]),e._v(" are ignored.")]),e._v(" "),s("li",[s("code",[e._v("socket")]),e._v(" {stream.Duplex} Establish secure connection on a given socket\nrather than creating a new socket. Typically, this is an instance of\n"),s("router-link",{attrs:{to:"/node/net.html#net_class_net_socket"}},[s("code",[e._v("net.Socket")])]),e._v(", but any "),s("code",[e._v("Duplex")]),e._v(" stream is allowed.\nIf this option is specified, "),s("code",[e._v("path")]),e._v(", "),s("code",[e._v("host")]),e._v(" and "),s("code",[e._v("port")]),e._v(" are ignored,\nexcept for certificate validation. Usually, a socket is already connected\nwhen passed to "),s("code",[e._v("tls.connect()")]),e._v(", but it can be connected later.\nConnection/disconnection/destruction of "),s("code",[e._v("socket")]),e._v(" is the user's\nresponsibility; calling "),s("code",[e._v("tls.connect()")]),e._v(" will not cause "),s("code",[e._v("net.connect()")]),e._v(" to be\ncalled.")],1),e._v(" "),s("li",[s("code",[e._v("allowHalfOpen")]),e._v(" {boolean} If the "),s("code",[e._v("socket")]),e._v(" option is missing, indicates\nwhether or not to allow the internally created socket to be half-open,\notherwise the option is ignored. See the "),s("code",[e._v("allowHalfOpen")]),e._v(" option of\n"),s("router-link",{attrs:{to:"/node/net.html#net_class_net_socket"}},[s("code",[e._v("net.Socket")])]),e._v(" for details. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("false")]),e._v(".")],1),e._v(" "),s("li",[s("code",[e._v("rejectUnauthorized")]),e._v(" {boolean} If not "),s("code",[e._v("false")]),e._v(", the server certificate is\nverified against the list of supplied CAs. An "),s("code",[e._v("'error'")]),e._v(" event is emitted if\nverification fails; "),s("code",[e._v("err.code")]),e._v(" contains the OpenSSL error code. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("true")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("ALPNProtocols")]),e._v(": {string[]|Buffer[]|TypedArray[]|DataView[]|Buffer|\nTypedArray|DataView}\nAn array of strings, "),s("code",[e._v("Buffer")]),e._v("s or "),s("code",[e._v("TypedArray")]),e._v("s or "),s("code",[e._v("DataView")]),e._v("s, or a\nsingle "),s("code",[e._v("Buffer")]),e._v(" or "),s("code",[e._v("TypedArray")]),e._v(" or "),s("code",[e._v("DataView")]),e._v(" containing the supported ALPN\nprotocols. "),s("code",[e._v("Buffer")]),e._v("s should have the format "),s("code",[e._v("[len][name][len][name]...")]),e._v("\ne.g. "),s("code",[e._v("'\\x08http/1.1\\x08http/1.0'")]),e._v(", where the "),s("code",[e._v("len")]),e._v(" byte is the length of the\nnext protocol name. Passing an array is usually much simpler, e.g.\n"),s("code",[e._v("['http/1.1', 'http/1.0']")]),e._v(". Protocols earlier in the list have higher\npreference than those later.")]),e._v(" "),s("li",[s("code",[e._v("servername")]),e._v(": {string} Server name for the SNI (Server Name Indication) TLS\nextension. It is the name of the host being connected to, and must be a host\nname, and not an IP address. It can be used by a multi-homed server to\nchoose the correct certificate to present to the client, see the\n"),s("code",[e._v("SNICallback")]),e._v(" option to "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("checkServerIdentity(servername, cert)")]),e._v(" {Function} A callback function\nto be used (instead of the builtin "),s("code",[e._v("tls.checkServerIdentity()")]),e._v(" function)\nwhen checking the server's hostname (or the provided "),s("code",[e._v("servername")]),e._v(" when\nexplicitly set) against the certificate. This should return an {Error} if\nverification fails. The method should return "),s("code",[e._v("undefined")]),e._v(" if the "),s("code",[e._v("servername")]),e._v("\nand "),s("code",[e._v("cert")]),e._v(" are verified.")]),e._v(" "),s("li",[s("code",[e._v("session")]),e._v(" {Buffer} A "),s("code",[e._v("Buffer")]),e._v(" instance, containing TLS session.")]),e._v(" "),s("li",[s("code",[e._v("minDHSize")]),e._v(" {number} Minimum size of the DH parameter in bits to accept a\nTLS connection. When a server offers a DH parameter with a size less\nthan "),s("code",[e._v("minDHSize")]),e._v(", the TLS connection is destroyed and an error is thrown.\n"),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("1024")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("secureContext")]),e._v(": TLS context object created with\n"),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(". If a "),s("code",[e._v("secureContext")]),e._v(" is "),s("em",[e._v("not")]),e._v(" provided, one\nwill be created by passing the entire "),s("code",[e._v("options")]),e._v(" object to\n"),s("code",[e._v("tls.createSecureContext()")]),e._v(".")]),e._v(" "),s("li",[e._v("...: "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(" options that are used if the\n"),s("code",[e._v("secureContext")]),e._v(" option is missing, otherwise they are ignored.")]),e._v(" "),s("li",[e._v("...: Any "),s("router-link",{attrs:{to:"/node/net.html#net_socket_connect_options_connectlistener"}},[s("code",[e._v("socket.connect()")])]),e._v(" option not already listed.")],1)])]),e._v(" "),s("li",[s("code",[e._v("callback")]),e._v(" {Function}")]),e._v(" "),s("li",[e._v("Returns: {tls.TLSSocket}")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("callback")]),e._v(" function, if specified, will be added as a listener for the\n"),s("a",{attrs:{href:"#tls_event_secureconnect"}},[s("code",[e._v("'secureConnect'")])]),e._v(" event.")]),e._v(" "),s("p",[s("code",[e._v("tls.connect()")]),e._v(" returns a "),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v(" object.")]),e._v(" "),s("p",[e._v("The following illustrates a client for the echo server example from\n"),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Assumes an echo server that is listening on port 8000.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" tls "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'tls'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Necessary only if the server requires client certificate authentication.")]),e._v("\n  key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'client-key.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  cert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'client-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Necessary only if the server uses a self-signed certificate.")]),e._v("\n  ca"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'server-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Necessary only if the server's cert isn't for \"localhost\".")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("checkServerIdentity")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" socket "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" tls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'client connected'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n              socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("authorized "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'authorized'")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'unauthorized'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("stdin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("stdin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resume")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nsocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("setEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nsocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nsocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'end'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'server ends connection'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("h2",{attrs:{id:"tls-connect-path-options-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-connect-path-options-callback"}},[e._v("#")]),e._v(" tls.connect(path[, options][, callback])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("path")]),e._v(" {string} Default value for "),s("code",[e._v("options.path")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("options")]),e._v(" {Object} See "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("callback")]),e._v(" {Function} See "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(".")]),e._v(" "),s("li",[e._v("Returns: {tls.TLSSocket}")])]),e._v(" "),s("p",[e._v("Same as "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(" except that "),s("code",[e._v("path")]),e._v(" can be provided\nas an argument instead of an option.")]),e._v(" "),s("p",[e._v("A path option, if specified, will take precedence over the path argument.")]),e._v(" "),s("h2",{attrs:{id:"tls-connect-port-host-options-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-connect-port-host-options-callback"}},[e._v("#")]),e._v(" tls.connect(port[, host][, options][, callback])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("port")]),e._v(" {number} Default value for "),s("code",[e._v("options.port")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("host")]),e._v(" {string} Default value for "),s("code",[e._v("options.host")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("options")]),e._v(" {Object} See "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("callback")]),e._v(" {Function} See "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(".")]),e._v(" "),s("li",[e._v("Returns: {tls.TLSSocket}")])]),e._v(" "),s("p",[e._v("Same as "),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(" except that "),s("code",[e._v("port")]),e._v(" and "),s("code",[e._v("host")]),e._v(" can be provided\nas arguments instead of options.")]),e._v(" "),s("p",[e._v("A port or host option, if specified, will take precedence over any port or host\nargument.")]),e._v(" "),s("h2",{attrs:{id:"tls-createsecurecontext-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-createsecurecontext-options"}},[e._v("#")]),e._v(" tls.createSecureContext([options])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("options")]),e._v(" {Object}\n"),s("ul",[s("li",[s("code",[e._v("ca")]),e._v(" {string|string[]|Buffer|Buffer[]} Optionally override the trusted CA\ncertificates. Default is to trust the well-known CAs curated by Mozilla.\nMozilla's CAs are completely replaced when CAs are explicitly specified\nusing this option. The value can be a string or "),s("code",[e._v("Buffer")]),e._v(", or an "),s("code",[e._v("Array")]),e._v(" of\nstrings and/or "),s("code",[e._v("Buffer")]),e._v("s. Any string or "),s("code",[e._v("Buffer")]),e._v(" can contain multiple PEM\nCAs concatenated together. The peer's certificate must be chainable to a CA\ntrusted by the server for the connection to be authenticated. When using\ncertificates that are not chainable to a well-known CA, the certificate's CA\nmust be explicitly specified as a trusted or the connection will fail to\nauthenticate.\nIf the peer uses a certificate that doesn't match or chain to one of the\ndefault CAs, use the "),s("code",[e._v("ca")]),e._v(' option to provide a CA certificate that the peer\'s\ncertificate can match or chain to.\nFor self-signed certificates, the certificate is its own CA, and must be\nprovided.\nFor PEM encoded certificates, supported types are "TRUSTED CERTIFICATE",\n"X509 CERTIFICATE", and "CERTIFICATE".\nSee also '),s("a",{attrs:{href:"#tls_tls_rootcertificates"}},[s("code",[e._v("tls.rootCertificates")])]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("cert")]),e._v(" {string|string[]|Buffer|Buffer[]} Cert chains in PEM format. One cert\nchain should be provided per private key. Each cert chain should consist of\nthe PEM formatted certificate for a provided private "),s("code",[e._v("key")]),e._v(", followed by the\nPEM formatted intermediate certificates (if any), in order, and not\nincluding the root CA (the root CA must be pre-known to the peer, see "),s("code",[e._v("ca")]),e._v(").\nWhen providing multiple cert chains, they do not have to be in the same\norder as their private keys in "),s("code",[e._v("key")]),e._v(". If the intermediate certificates are\nnot provided, the peer will not be able to validate the certificate, and the\nhandshake will fail.")]),e._v(" "),s("li",[s("code",[e._v("sigalgs")]),e._v(" {string} Colon-separated list of supported signature algorithms.\nThe list can contain digest algorithms ("),s("code",[e._v("SHA256")]),e._v(", "),s("code",[e._v("MD5")]),e._v(" etc.), public key\nalgorithms ("),s("code",[e._v("RSA-PSS")]),e._v(", "),s("code",[e._v("ECDSA")]),e._v(" etc.), combination of both (e.g\n'RSA+SHA384') or TLS v1.3 scheme names (e.g. "),s("code",[e._v("rsa_pss_pss_sha512")]),e._v(").\nSee "),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man3/SSL_CTX_set1_sigalgs_list.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenSSL man pages"),s("OutboundLink")],1),e._v("\nfor more info.")]),e._v(" "),s("li",[s("code",[e._v("ciphers")]),e._v(" {string} Cipher suite specification, replacing the default. For\nmore information, see "),s("a",{attrs:{href:"#tls_modifying_the_default_tls_cipher_suite"}},[e._v("modifying the default cipher suite")]),e._v(". Permitted\nciphers can be obtained via "),s("a",{attrs:{href:"#tls_tls_getciphers"}},[s("code",[e._v("tls.getCiphers()")])]),e._v(". Cipher names must be\nuppercased in order for OpenSSL to accept them.")]),e._v(" "),s("li",[s("code",[e._v("clientCertEngine")]),e._v(" {string} Name of an OpenSSL engine which can provide the\nclient certificate.")]),e._v(" "),s("li",[s("code",[e._v("crl")]),e._v(" {string|string[]|Buffer|Buffer[]} PEM formatted CRLs (Certificate\nRevocation Lists).")]),e._v(" "),s("li",[s("code",[e._v("dhparam")]),e._v(" {string|Buffer} Diffie Hellman parameters, required for\n"),s("a",{attrs:{href:"#tls_perfect_forward_secrecy"}},[e._v("Perfect Forward Secrecy")]),e._v(". Use "),s("code",[e._v("openssl dhparam")]),e._v(" to create the parameters.\nThe key length must be greater than or equal to 1024 bits or else an error\nwill be thrown. Although 1024 bits is permissible, use 2048 bits or larger\nfor stronger security. If omitted or invalid, the parameters are silently\ndiscarded and DHE ciphers will not be available.")]),e._v(" "),s("li",[s("code",[e._v("ecdhCurve")]),e._v(" {string} A string describing a named curve or a colon separated\nlist of curve NIDs or names, for example "),s("code",[e._v("P-521:P-384:P-256")]),e._v(", to use for\nECDH key agreement. Set to "),s("code",[e._v("auto")]),e._v(" to select the\ncurve automatically. Use "),s("router-link",{attrs:{to:"/node/crypto.html#crypto_crypto_getcurves"}},[s("code",[e._v("crypto.getCurves()")])]),e._v(" to obtain a list of\navailable curve names. On recent releases, "),s("code",[e._v("openssl ecparam -list_curves")]),e._v("\nwill also display the name and description of each available elliptic curve.\n"),s("strong",[e._v("Default:")]),e._v(" "),s("a",{attrs:{href:"#tls_tls_default_ecdh_curve"}},[s("code",[e._v("tls.DEFAULT_ECDH_CURVE")])]),e._v(".")],1),e._v(" "),s("li",[s("code",[e._v("honorCipherOrder")]),e._v(" {boolean} Attempt to use the server's cipher suite\npreferences instead of the client's. When "),s("code",[e._v("true")]),e._v(", causes\n"),s("code",[e._v("SSL_OP_CIPHER_SERVER_PREFERENCE")]),e._v(" to be set in "),s("code",[e._v("secureOptions")]),e._v(", see\n"),s("router-link",{attrs:{to:"/node/crypto.html#crypto_openssl_options"}},[e._v("OpenSSL Options")]),e._v(" for more information.")],1),e._v(" "),s("li",[s("code",[e._v("key")]),e._v(" {string|string[]|Buffer|Buffer[]|Object[]} Private keys in PEM format.\nPEM allows the option of private keys being encrypted. Encrypted keys will\nbe decrypted with "),s("code",[e._v("options.passphrase")]),e._v(". Multiple keys using different\nalgorithms can be provided either as an array of unencrypted key strings or\nbuffers, or an array of objects in the form\n"),s("code",[e._v("{pem: <string|buffer>[, passphrase: <string>]}")]),e._v(". The object form can only\noccur in an array. "),s("code",[e._v("object.passphrase")]),e._v(" is optional. Encrypted keys will be\ndecrypted with "),s("code",[e._v("object.passphrase")]),e._v(" if provided, or "),s("code",[e._v("options.passphrase")]),e._v(" if\nit is not.")]),e._v(" "),s("li",[s("code",[e._v("privateKeyEngine")]),e._v(" {string} Name of an OpenSSL engine to get private key\nfrom. Should be used together with "),s("code",[e._v("privateKeyIdentifier")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("privateKeyIdentifier")]),e._v(" {string} Identifier of a private key managed by\nan OpenSSL engine. Should be used together with "),s("code",[e._v("privateKeyEngine")]),e._v(".\nShould not be set together with "),s("code",[e._v("key")]),e._v(", because both options define a\nprivate key in different ways.")]),e._v(" "),s("li",[s("code",[e._v("maxVersion")]),e._v(" {string} Optionally set the maximum TLS version to allow. One\nof "),s("code",[e._v("'TLSv1.3'")]),e._v(", "),s("code",[e._v("'TLSv1.2'")]),e._v(", "),s("code",[e._v("'TLSv1.1'")]),e._v(", or "),s("code",[e._v("'TLSv1'")]),e._v(". Cannot be specified\nalong with the "),s("code",[e._v("secureProtocol")]),e._v(" option, use one or the other.\n"),s("strong",[e._v("Default:")]),e._v(" "),s("a",{attrs:{href:"#tls_tls_default_max_version"}},[s("code",[e._v("tls.DEFAULT_MAX_VERSION")])]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("minVersion")]),e._v(" {string} Optionally set the minimum TLS version to allow. One\nof "),s("code",[e._v("'TLSv1.3'")]),e._v(", "),s("code",[e._v("'TLSv1.2'")]),e._v(", "),s("code",[e._v("'TLSv1.1'")]),e._v(", or "),s("code",[e._v("'TLSv1'")]),e._v(". Cannot be specified\nalong with the "),s("code",[e._v("secureProtocol")]),e._v(" option, use one or the other. It is not\nrecommended to use less than TLSv1.2, but it may be required for\ninteroperability.\n"),s("strong",[e._v("Default:")]),e._v(" "),s("a",{attrs:{href:"#tls_tls_default_min_version"}},[s("code",[e._v("tls.DEFAULT_MIN_VERSION")])]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("passphrase")]),e._v(" {string} Shared passphrase used for a single private key and/or\na PFX.")]),e._v(" "),s("li",[s("code",[e._v("pfx")]),e._v(" {string|string[]|Buffer|Buffer[]|Object[]} PFX or PKCS12 encoded\nprivate key and certificate chain. "),s("code",[e._v("pfx")]),e._v(" is an alternative to providing\n"),s("code",[e._v("key")]),e._v(" and "),s("code",[e._v("cert")]),e._v(" individually. PFX is usually encrypted, if it is,\n"),s("code",[e._v("passphrase")]),e._v(" will be used to decrypt it. Multiple PFX can be provided either\nas an array of unencrypted PFX buffers, or an array of objects in the form\n"),s("code",[e._v("{buf: <string|buffer>[, passphrase: <string>]}")]),e._v(". The object form can only\noccur in an array. "),s("code",[e._v("object.passphrase")]),e._v(" is optional. Encrypted PFX will be\ndecrypted with "),s("code",[e._v("object.passphrase")]),e._v(" if provided, or "),s("code",[e._v("options.passphrase")]),e._v(" if\nit is not.")]),e._v(" "),s("li",[s("code",[e._v("secureOptions")]),e._v(" {number} Optionally affect the OpenSSL protocol behavior,\nwhich is not usually necessary. This should be used carefully if at all!\nValue is a numeric bitmask of the "),s("code",[e._v("SSL_OP_*")]),e._v(" options from\n"),s("router-link",{attrs:{to:"/node/crypto.html#crypto_openssl_options"}},[e._v("OpenSSL Options")]),e._v(".")],1),e._v(" "),s("li",[s("code",[e._v("secureProtocol")]),e._v(" {string} Legacy mechanism to select the TLS protocol\nversion to use, it does not support independent control of the minimum and\nmaximum version, and does not support limiting the protocol to TLSv1.3.  Use\n"),s("code",[e._v("minVersion")]),e._v(" and "),s("code",[e._v("maxVersion")]),e._v(" instead.  The possible values are listed as\n"),s("a",{attrs:{href:"https://www.openssl.org/docs/man1.1.1/man7/ssl.html#Dealing-with-Protocol-Methods",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSL_METHODS"),s("OutboundLink")],1),e._v(", use the function names as strings.  For example, use\n"),s("code",[e._v("'TLSv1_1_method'")]),e._v(" to force TLS version 1.1, or "),s("code",[e._v("'TLS_method'")]),e._v(" to allow any\nTLS protocol version up to TLSv1.3.  It is not recommended to use TLS\nversions less than 1.2, but it may be required for interoperability.\n"),s("strong",[e._v("Default:")]),e._v(" none, see "),s("code",[e._v("minVersion")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("sessionIdContext")]),e._v(" {string} Opaque identifier used by servers to ensure\nsession state is not shared between applications. Unused by clients.")])])])]),e._v(" "),s("p",[s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(" sets the default value of the "),s("code",[e._v("honorCipherOrder")]),e._v(" option\nto "),s("code",[e._v("true")]),e._v(", other APIs that create secure contexts leave it unset.")]),e._v(" "),s("p",[s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v(" uses a 128 bit truncated SHA1 hash value generated\nfrom "),s("code",[e._v("process.argv")]),e._v(" as the default value of the "),s("code",[e._v("sessionIdContext")]),e._v(" option, other\nAPIs that create secure contexts have no default value.")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tls.createSecureContext()")]),e._v(" method creates a "),s("code",[e._v("SecureContext")]),e._v(" object. It is\nusable as an argument to several "),s("code",[e._v("tls")]),e._v(" APIs, such as "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])]),e._v("\nand "),s("a",{attrs:{href:"#tls_server_addcontext_hostname_context"}},[s("code",[e._v("server.addContext()")])]),e._v(", but has no public methods.")]),e._v(" "),s("p",[e._v("A key is "),s("em",[e._v("required")]),e._v(" for ciphers that make use of certificates. Either "),s("code",[e._v("key")]),e._v(" or\n"),s("code",[e._v("pfx")]),e._v(" can be used to provide it.")]),e._v(" "),s("p",[e._v("If the "),s("code",[e._v("ca")]),e._v(" option is not given, then Node.js will default to using\n"),s("a",{attrs:{href:"https://hg.mozilla.org/mozilla-central/raw-file/tip/security/nss/lib/ckfw/builtins/certdata.txt",target:"_blank",rel:"noopener noreferrer"}},[e._v("Mozilla's publicly trusted list of CAs"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"tls-createserver-options-secureconnectionlistener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-createserver-options-secureconnectionlistener"}},[e._v("#")]),e._v(" tls.createServer([options][, secureConnectionListener])")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("options")]),e._v(" {Object}\n"),s("ul",[s("li",[s("code",[e._v("ALPNProtocols")]),e._v(": {string[]|Buffer[]|TypedArray[]|DataView[]|Buffer|\nTypedArray|DataView}\nAn array of strings, "),s("code",[e._v("Buffer")]),e._v("s or "),s("code",[e._v("TypedArray")]),e._v("s or "),s("code",[e._v("DataView")]),e._v("s, or a single\n"),s("code",[e._v("Buffer")]),e._v(" or "),s("code",[e._v("TypedArray")]),e._v(" or "),s("code",[e._v("DataView")]),e._v(" containing the supported ALPN\nprotocols. "),s("code",[e._v("Buffer")]),e._v("s should have the format "),s("code",[e._v("[len][name][len][name]...")]),e._v("\ne.g. "),s("code",[e._v("0x05hello0x05world")]),e._v(", where the first byte is the length of the next\nprotocol name. Passing an array is usually much simpler, e.g.\n"),s("code",[e._v("['hello', 'world']")]),e._v(". (Protocols should be ordered by their priority.)")]),e._v(" "),s("li",[s("code",[e._v("clientCertEngine")]),e._v(" {string} Name of an OpenSSL engine which can provide the\nclient certificate.")]),e._v(" "),s("li",[s("code",[e._v("enableTrace")]),e._v(" {boolean} If "),s("code",[e._v("true")]),e._v(", "),s("a",{attrs:{href:"#tls_tlssocket_enabletrace"}},[s("code",[e._v("tls.TLSSocket.enableTrace()")])]),e._v(" will be\ncalled on new connections. Tracing can be enabled after the secure\nconnection is established, but this option must be used to trace the secure\nconnection setup. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("false")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("handshakeTimeout")]),e._v(" {number} Abort the connection if the SSL/TLS handshake\ndoes not finish in the specified number of milliseconds.\nA "),s("code",[e._v("'tlsClientError'")]),e._v(" is emitted on the "),s("code",[e._v("tls.Server")]),e._v(" object whenever\na handshake times out. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("120000")]),e._v(" (120 seconds).")]),e._v(" "),s("li",[s("code",[e._v("rejectUnauthorized")]),e._v(" {boolean} If not "),s("code",[e._v("false")]),e._v(" the server will reject any\nconnection which is not authorized with the list of supplied CAs. This\noption only has an effect if "),s("code",[e._v("requestCert")]),e._v(" is "),s("code",[e._v("true")]),e._v(". "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("true")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("requestCert")]),e._v(" {boolean} If "),s("code",[e._v("true")]),e._v(" the server will request a certificate from\nclients that connect and attempt to verify that certificate. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("false")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("sessionTimeout")]),e._v(" {number} The number of seconds after which a TLS session\ncreated by the server will no longer be resumable. See\n"),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information. "),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("300")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("SNICallback(servername, cb)")]),e._v(" {Function} A function that will be called if\nthe client supports SNI TLS extension. Two arguments will be passed when\ncalled: "),s("code",[e._v("servername")]),e._v(" and "),s("code",[e._v("cb")]),e._v(". "),s("code",[e._v("SNICallback")]),e._v(" should invoke "),s("code",[e._v("cb(null, ctx)")]),e._v(",\nwhere "),s("code",[e._v("ctx")]),e._v(" is a "),s("code",[e._v("SecureContext")]),e._v(" instance. ("),s("code",[e._v("tls.createSecureContext(...)")]),e._v("\ncan be used to get a proper "),s("code",[e._v("SecureContext")]),e._v(".) If "),s("code",[e._v("SNICallback")]),e._v(" wasn't\nprovided the default callback with high-level API will be used (see below).")]),e._v(" "),s("li",[s("code",[e._v("ticketKeys")]),e._v(": {Buffer} 48-bytes of cryptographically strong pseudo-random\ndata. See "),s("a",{attrs:{href:"#tls_session_resumption"}},[e._v("Session Resumption")]),e._v(" for more information.")]),e._v(" "),s("li",[e._v("...: Any "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(" option can be provided. For\nservers, the identity options ("),s("code",[e._v("pfx")]),e._v(" or "),s("code",[e._v("key")]),e._v("/"),s("code",[e._v("cert")]),e._v(") are usually required.")]),e._v(" "),s("li",[e._v("...: Any "),s("router-link",{attrs:{to:"/node/net.html#net_net_createserver_options_connectionlistener"}},[s("code",[e._v("net.createServer()")])]),e._v(" option can be provided.")],1)])]),e._v(" "),s("li",[s("code",[e._v("secureConnectionListener")]),e._v(" {Function}")]),e._v(" "),s("li",[e._v("Returns: {tls.Server}")])]),e._v(" "),s("p",[e._v("Creates a new "),s("a",{attrs:{href:"#tls_class_tls_server"}},[s("code",[e._v("tls.Server")])]),e._v(". The "),s("code",[e._v("secureConnectionListener")]),e._v(", if provided, is\nautomatically set as a listener for the "),s("a",{attrs:{href:"#tls_event_secureconnection"}},[s("code",[e._v("'secureConnection'")])]),e._v(" event.")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("ticketKeys")]),e._v(" options is automatically shared between "),s("code",[e._v("cluster")]),e._v(" module\nworkers.")]),e._v(" "),s("p",[e._v("The following illustrates a simple echo server:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" tls "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'tls'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'server-key.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  cert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'server-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// This is necessary only if using client certificate authentication.")]),e._v("\n  requestCert"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// This is necessary only if the client uses a self-signed certificate.")]),e._v("\n  ca"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("readFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'client-cert.pem'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" server "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" tls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("createServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("socket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'server connected'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n              socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("authorized "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'authorized'")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'unauthorized'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'welcome!\\n'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("setEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'utf8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("listen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'server bound'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("The server can be tested by connecting to it using the example client from\n"),s("a",{attrs:{href:"#tls_tls_connect_options_callback"}},[s("code",[e._v("tls.connect()")])]),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"tls-getciphers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-getciphers"}},[e._v("#")]),e._v(" tls.getCiphers()")]),e._v(" "),s("ul",[s("li",[e._v("Returns: {string[]}")])]),e._v(" "),s("p",[e._v("Returns an array with the names of the supported TLS ciphers. The names are\nlower-case for historical reasons, but must be uppercased to be used in\nthe "),s("code",[e._v("ciphers")]),e._v(" option of "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(".")]),e._v(" "),s("p",[e._v("Cipher names that start with "),s("code",[e._v("'tls_'")]),e._v(" are for TLSv1.3, all the others are for\nTLSv1.2 and below.")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("tls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("getCiphers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// ['aes128-gcm-sha256', 'aes128-sha', ...]")]),e._v("\n")])])]),s("h2",{attrs:{id:"tls-rootcertificates"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-rootcertificates"}},[e._v("#")]),e._v(" tls.rootCertificates")]),e._v(" "),s("ul",[s("li",[e._v("{string[]}")])]),e._v(" "),s("p",[e._v("An immutable array of strings representing the root certificates (in PEM format)\nused for verifying peer certificates. This is the default value of the "),s("code",[e._v("ca")]),e._v("\noption to "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"tls-default-ecdh-curve"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-default-ecdh-curve"}},[e._v("#")]),e._v(" tls.DEFAULT_ECDH_CURVE")]),e._v(" "),s("p",[e._v("The default curve name to use for ECDH key agreement in a tls server. The\ndefault value is "),s("code",[e._v("'auto'")]),e._v(". See "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(" for further\ninformation.")]),e._v(" "),s("h2",{attrs:{id:"tls-default-max-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-default-max-version"}},[e._v("#")]),e._v(" tls.DEFAULT_MAX_VERSION")]),e._v(" "),s("ul",[s("li",[e._v("{string} The default value of the "),s("code",[e._v("maxVersion")]),e._v(" option of\n"),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(". It can be assigned any of the supported TLS\nprotocol versions, "),s("code",[e._v("'TLSv1.3'")]),e._v(", "),s("code",[e._v("'TLSv1.2'")]),e._v(", "),s("code",[e._v("'TLSv1.1'")]),e._v(", or "),s("code",[e._v("'TLSv1'")]),e._v(".\n"),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("'TLSv1.3'")]),e._v(", unless changed using CLI options. Using\n"),s("code",[e._v("--tls-max-v1.2")]),e._v(" sets the default to "),s("code",[e._v("'TLSv1.2'")]),e._v(".  Using "),s("code",[e._v("--tls-max-v1.3")]),e._v(" sets\nthe default to "),s("code",[e._v("'TLSv1.3'")]),e._v(". If multiple of the options are provided, the\nhighest maximum is used.")])]),e._v(" "),s("h2",{attrs:{id:"tls-default-min-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-default-min-version"}},[e._v("#")]),e._v(" tls.DEFAULT_MIN_VERSION")]),e._v(" "),s("ul",[s("li",[e._v("{string} The default value of the "),s("code",[e._v("minVersion")]),e._v(" option of\n"),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])]),e._v(". It can be assigned any of the supported TLS\nprotocol versions, "),s("code",[e._v("'TLSv1.3'")]),e._v(", "),s("code",[e._v("'TLSv1.2'")]),e._v(", "),s("code",[e._v("'TLSv1.1'")]),e._v(", or "),s("code",[e._v("'TLSv1'")]),e._v(".\n"),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("'TLSv1.2'")]),e._v(", unless changed using CLI options. Using\n"),s("code",[e._v("--tls-min-v1.0")]),e._v(" sets the default to "),s("code",[e._v("'TLSv1'")]),e._v(". Using "),s("code",[e._v("--tls-min-v1.1")]),e._v(" sets\nthe default to "),s("code",[e._v("'TLSv1.1'")]),e._v(". Using "),s("code",[e._v("--tls-min-v1.3")]),e._v(" sets the default to\n"),s("code",[e._v("'TLSv1.3'")]),e._v(". If multiple of the options are provided, the lowest minimum is\nused.")])]),e._v(" "),s("h2",{attrs:{id:"deprecated-apis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deprecated-apis"}},[e._v("#")]),e._v(" Deprecated APIs")]),e._v(" "),s("h3",{attrs:{id:"class-cryptostream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-cryptostream"}},[e._v("#")]),e._v(" Class: CryptoStream")]),e._v(" "),s("blockquote",[s("p",[e._v("Stability: 0 - Deprecated: Use "),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v(" instead.")])]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tls.CryptoStream")]),e._v(" class represents a stream of encrypted data. This class\nis deprecated and should no longer be used.")]),e._v(" "),s("h4",{attrs:{id:"cryptostream-byteswritten"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cryptostream-byteswritten"}},[e._v("#")]),e._v(" cryptoStream.bytesWritten")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("cryptoStream.bytesWritten")]),e._v(" property returns the total number of bytes\nwritten to the underlying socket "),s("em",[e._v("including")]),e._v(" the bytes required for the\nimplementation of the TLS protocol.")]),e._v(" "),s("h3",{attrs:{id:"class-securepair"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-securepair"}},[e._v("#")]),e._v(" Class: SecurePair")]),e._v(" "),s("blockquote",[s("p",[e._v("Stability: 0 - Deprecated: Use "),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v(" instead.")])]),e._v(" "),s("p",[e._v("Returned by "),s("a",{attrs:{href:"#tls_tls_createsecurepair_context_isserver_requestcert_rejectunauthorized_options"}},[s("code",[e._v("tls.createSecurePair()")])]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"event-secure"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-secure"}},[e._v("#")]),e._v(" Event: 'secure'")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("'secure'")]),e._v(" event is emitted by the "),s("code",[e._v("SecurePair")]),e._v(" object once a secure\nconnection has been established.")]),e._v(" "),s("p",[e._v("As with checking for the server\n"),s("a",{attrs:{href:"#tls_event_secureconnection"}},[s("code",[e._v("'secureConnection'")])]),e._v("\nevent, "),s("code",[e._v("pair.cleartext.authorized")]),e._v(" should be inspected to confirm whether the\ncertificate used is properly authorized.")]),e._v(" "),s("h3",{attrs:{id:"tls-createsecurepair-context-isserver-requestcert-rejectunauthorized-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tls-createsecurepair-context-isserver-requestcert-rejectunauthorized-options"}},[e._v("#")]),e._v(" tls.createSecurePair([context][, isServer][, requestCert][, rejectUnauthorized][, options])")]),e._v(" "),s("blockquote",[s("p",[e._v("Stability: 0 - Deprecated: Use "),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v(" instead.")])]),e._v(" "),s("ul",[s("li",[s("code",[e._v("context")]),e._v(" {Object} A secure context object as returned by\n"),s("code",[e._v("tls.createSecureContext()")])]),e._v(" "),s("li",[s("code",[e._v("isServer")]),e._v(" {boolean} "),s("code",[e._v("true")]),e._v(" to specify that this TLS connection should be\nopened as a server.")]),e._v(" "),s("li",[s("code",[e._v("requestCert")]),e._v(" {boolean} "),s("code",[e._v("true")]),e._v(" to specify whether a server should request a\ncertificate from a connecting client. Only applies when "),s("code",[e._v("isServer")]),e._v(" is "),s("code",[e._v("true")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("rejectUnauthorized")]),e._v(" {boolean} If not "),s("code",[e._v("false")]),e._v(" a server automatically reject\nclients with invalid certificates. Only applies when "),s("code",[e._v("isServer")]),e._v(" is "),s("code",[e._v("true")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("options")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("enableTrace")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("secureContext")]),e._v(": A TLS context object from "),s("a",{attrs:{href:"#tls_tls_createsecurecontext_options"}},[s("code",[e._v("tls.createSecureContext()")])])]),e._v(" "),s("li",[s("code",[e._v("isServer")]),e._v(": If "),s("code",[e._v("true")]),e._v(" the TLS socket will be instantiated in server-mode.\n"),s("strong",[e._v("Default:")]),e._v(" "),s("code",[e._v("false")]),e._v(".")]),e._v(" "),s("li",[s("code",[e._v("server")]),e._v(" {net.Server} A "),s("router-link",{attrs:{to:"/node/net.html#net_class_net_server"}},[s("code",[e._v("net.Server")])]),e._v(" instance")],1),e._v(" "),s("li",[s("code",[e._v("requestCert")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("rejectUnauthorized")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("ALPNProtocols")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("SNICallback")]),e._v(": See "),s("a",{attrs:{href:"#tls_tls_createserver_options_secureconnectionlistener"}},[s("code",[e._v("tls.createServer()")])])]),e._v(" "),s("li",[s("code",[e._v("session")]),e._v(" {Buffer} A "),s("code",[e._v("Buffer")]),e._v(" instance containing a TLS session.")]),e._v(" "),s("li",[s("code",[e._v("requestOCSP")]),e._v(" {boolean} If "),s("code",[e._v("true")]),e._v(", specifies that the OCSP status request\nextension will be added to the client hello and an "),s("code",[e._v("'OCSPResponse'")]),e._v(" event\nwill be emitted on the socket before establishing a secure communication.")])])])]),e._v(" "),s("p",[e._v("Creates a new secure pair object with two streams, one of which reads and writes\nthe encrypted data and the other of which reads and writes the cleartext data.\nGenerally, the encrypted stream is piped to/from an incoming encrypted data\nstream and the cleartext one is used as a replacement for the initial encrypted\nstream.")]),e._v(" "),s("p",[s("code",[e._v("tls.createSecurePair()")]),e._v(" returns a "),s("code",[e._v("tls.SecurePair")]),e._v(" object with "),s("code",[e._v("cleartext")]),e._v(" and\n"),s("code",[e._v("encrypted")]),e._v(" stream properties.")]),e._v(" "),s("p",[e._v("Using "),s("code",[e._v("cleartext")]),e._v(" has the same API as "),s("a",{attrs:{href:"#tls_class_tls_tlssocket"}},[s("code",[e._v("tls.TLSSocket")])]),e._v(".")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("tls.createSecurePair()")]),e._v(" method is now deprecated in favor of\n"),s("code",[e._v("tls.TLSSocket()")]),e._v(". For example, the code:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("pair "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" tls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("createSecurePair")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("/* ... */")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\npair"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("encrypted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nsocket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("pair"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("encrypted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("can be replaced by:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("secureSocket "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" tls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("TLSSocket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("socket"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("where "),s("code",[e._v("secureSocket")]),e._v(" has the same API as "),s("code",[e._v("pair.cleartext")]),e._v(".")])])}),[],!1,null,null,null);t.default=a.exports}}]);